(this.webpackJsonpgenify=this.webpackJsonpgenify||[]).push([[0],{212:function(e){e.exports=JSON.parse('{"logs":[{"version":"3.0.6","changes":["You can now set and save app options under the settings tab","Can enable automatic romanization of lyrics in settings to automatically romanize when new lyrics appear, if they aren\'t already"]},{"version":"3.0.5","changes":["(Re)fixed issue [#10](https://github.com/JoshLmao/Genify/issues/10) to allow cookies to stay after browser is closed"]},{"version":"3.0.4","changes":["Added navigation bar below player for changing focused content","Added settings page with information on signed in user","Can sign out of app to remove authorization","Can change and set the current playback device of Spotify"]},{"version":"3.0.3","changes":["Updated icon and added for mobile devices","Fixed issue [#7](https://github.com/JoshLmao/Genify/issues/7) where the white space from Genius was unexpected","Implemented a fix for issue [#8](https://github.com/JoshLmao/Genify/issues/8) causing app to crash and auth to not get updated"]},{"version":"3.0.2","changes":["Implemented new Spotify auth path: [Proof Key for Code Exchange](https://developer.spotify.com/documentation/general/guides/authorization-guide/#authorization-code-flow-with-proof-key-for-code-exchange-pkce)","Lyrics only get updated when track change"]},{"version":"3.0.1","changes":["Fixed the app using expired auth causing no access"]},{"version":"3.0.0: The React Update \ud83c\udf89","changes":["Changed site to use React","Site speed improved by a lot","Removed Youtube video player and options (for now)","Removed ability to change Spotify playback device (for now)","Improved overall app flow for getting user authorization","Added information about current Genius lyrics","Able to detect and romanize Russian lyrics","Can set the current playback time of the current Spotify track","User can set volume of current playback device","Can view and navigate to all artists on current track"]}]}')},221:function(e,t,a){e.exports=a(450)},249:function(e,t){},251:function(e,t){},262:function(e,t){},264:function(e,t){},289:function(e,t){},291:function(e,t){},292:function(e,t){},298:function(e,t){},300:function(e,t){},318:function(e,t){},321:function(e,t){},337:function(e,t){},340:function(e,t){},343:function(e,t,a){},424:function(e){e.exports=JSON.parse('{"name":"genify","version":"3.0.6","homepage":"https://genify.joshlmao.com","private":true,"dependencies":{"@fortawesome/fontawesome-svg-core":"^1.2.29","@fortawesome/free-brands-svg-icons":"^5.13.1","@fortawesome/free-solid-svg-icons":"^5.13.1","@fortawesome/react-fontawesome":"^0.1.11","@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.5.0","@testing-library/user-event":"^7.2.1","aromanize":"^0.1.5","axios":"^0.19.2","bootstrap":"^4.5.0","crypto-js":"^4.0.0","cyrillic-to-translit-js":"^3.1.0","js-cookie":"^2.2.1","kuroshiro":"^1.1.2","kuroshiro-analyzer-kuromoji":"^1.1.0","pinyin4js":"^1.3.18","react":"^16.13.1","react-bootstrap":"^1.1.1","react-bootstrap-range-slider":"^1.0.0","react-dom":"^16.13.1","react-markdown":"^4.3.1","react-router-dom":"^5.2.0","react-scripts":"3.4.1","traditional-or-simplified":"^1.0.3"},"scripts":{"predeploy":"npm run build","deploy":"gh-pages -d build -m \\"Updated live build to the latest changes\\"","start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"devDependencies":{"gh-pages":"^3.1.0"}}')},445:function(e,t,a){},449:function(e,t,a){},450:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(29),o=a.n(i);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var r=a(10),l=a(11),c=a(14),u=a(13),h=a(50),m=a(15),d=a(8),p=a(455),g=a(456),f=a(457),v=a(461),y=a(12),b=a(37),E=a(20),k=a.n(E),S="dZ7Y5s8PMg_oljOH1DgF_PDXXp-GvzF3g1OMlXh08Af~5J5hosQPQ4eNILnSf3IK.SKtnWlgANdHC.1.wSBw0ZqxtxBRsD7vkGV_f67RBa4DoFo0O3mrz5wB-3e17TsK",x="jZPEvjdl6Sk1RJUDoo0tTuEFYv2B8rbosLsOUnFBqbi11dCtfftjiN911-a9q0lo",C="https://genify-proxy.herokuapp.com/";var N=a(41),P=a.n(N),w=a(208),j=a.n(w),O=a(209),T=a.n(O),A=a(9);function R(e){var t=[];for(var a in e){var n=encodeURIComponent(a),s=encodeURIComponent(e[a]);t.push(n+"="+s)}return t=t.join("&")}function L(e){switch(e.toLowerCase()){case"tv":return A.n;case"computer":return A.e;case"smartphone":return A.f;case"tablet":return A.m;case"gameconsole":return A.c;case"speaker":return A.q;case"automobile":return A.a;default:return A.i}}var D={getPKCEAuthUri:function(){var e=encodeURIComponent("https://genify.joshlmao.com/callback"),t=encodeURIComponent(["streaming","user-read-currently-playing","user-read-playback-state","user-modify-playback-state","app-remote-control","user-read-email","user-read-private"].join(" ")),a=this.encodePKCEChallenge(S),n=a.method,s=a.challenge;return"https://accounts.spotify.com/authorize?"+["response_type=".concat("code"),"client_id=".concat("f4dc97c399124fc99254c5d7ac2bf4bd"),"redirect_uri=".concat(e),"code_challenge=".concat(s),"code_challenge_method=".concat(n),"state=".concat("genify-app"),"scope=".concat(t)].join("&")},encodePKCEChallenge:function(e){var t=j()(e);return{method:"S256",challenge:T.a.stringify(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}},exchangePKCECode:function(e,t){var a=R({grant_type:encodeURIComponent("authorization_code"),client_id:encodeURIComponent("f4dc97c399124fc99254c5d7ac2bf4bd"),code:encodeURIComponent(e),redirect_uri:"https://genify.joshlmao.com/callback",code_verifier:encodeURIComponent(S)});P()({method:"POST",url:"https://accounts.spotify.com/api/token",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},data:a,timeout:3e4}).then((function(e){t&&t(e.data)})).catch((function(e){console.error(e),console.error(e.response.data)}))},parseAuth:function(e){if(!e)return null;var t=e.expires_in,a=this.getAuthExpireTime(t),n=e.scope.split(" ");return{authToken:e.access_token,tokenType:e.token_type,scopes:n,refreshToken:e.refresh_token,expireDate:a}},refreshAuth:function(e,t){var a=this;if(e){var n=R({grant_type:encodeURIComponent("refresh_token"),refresh_token:e,client_id:encodeURIComponent("f4dc97c399124fc99254c5d7ac2bf4bd")});P()({method:"POST",url:"https://accounts.spotify.com/api/token",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},data:n,timeout:3e4}).then((function(e){t&&t(e.data)})).catch((function(e){a.handleApiError(e)}))}return null},handleApiError:function(e,t){var a,n,s,i;console.error("Spotify API Error: '".concat(t,"': '").concat(null!==(a=null===e||void 0===e||null===(n=e.response)||void 0===n||null===(s=n.data)||void 0===s||null===(i=s.error)||void 0===i?void 0:i.message)&&void 0!==a?a:e,"'"))},getAuthExpireTime:function(e){return new Date(Date.now()+1e3*e)},makeApiRequest:function(e,t,a,n){var s=this;P()({method:e,url:t,headers:{Authorization:"Bearer "+a},timeout:3e4}).then((function(e){n&&n(e.data)})).catch((function(e){s.handleApiError(e,t)}))},makeApiDataRequest:function(e,t,a,n,s){var i=this;P()({method:e,url:t,headers:{Authorization:"Bearer "+a},data:n,timeout:3e4}).then((function(e){s&&s(e.data)})).catch((function(e){i.handleApiError(e,t)}))},getCurrentPlaybackState:function(e,t){var a=this;P()({method:"GET",url:"https://api.spotify.com/v1/me/player/",headers:{Authorization:"Bearer "+e},timeout:3e4}).then((function(e){t&&t(e.data)})).catch((function(e){a.handleApiError(e)}))},pause:function(e){this.makeApiRequest("PUT","https://genify-proxy.herokuapp.com/https://api.spotify.com/v1/me/player/pause",e)},play:function(e){this.makeApiRequest("PUT","https://genify-proxy.herokuapp.com/https://api.spotify.com/v1/me/player/play",e)},previousTrack:function(e){this.makeApiRequest("POST","https://genify-proxy.herokuapp.com/https://api.spotify.com/v1/me/player/previous",e)},nextTrack:function(e){this.makeApiRequest("POST","https://genify-proxy.herokuapp.com/https://api.spotify.com/v1/me/player/next",e)},setVolume:function(e,t){var a=C+"https://api.spotify.com/v1/me/player/volume";a+="?volume_percent="+t,this.makeApiRequest("PUT",a,e)},seek:function(e,t){var a=C+"https://api.spotify.com/v1/me/player/seek";a+="?position_ms="+t,this.makeApiRequest("PUT",a,e)},getPlaybackDevices:function(e,t){this.makeApiRequest("GET","https://api.spotify.com/v1/me/player/devices",e,t)},setPlaybackDevice:function(e,t,a){var n={device_ids:[t],play:a};this.makeApiDataRequest("PUT","https://api.spotify.com/v1/me/player",e,n)},getCurrentUserProfile:function(e,t){this.makeApiRequest("GET","https://api.spotify.com/v1/me",e,t)}},z="spotify-auth",U="app-settings";a(343);function _(e){var t=null;try{t=JSON.parse(e)}catch(a){console.error("Unable to parse auth cookie")}return t}var I=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(r.a)(this,a),n=t.call(this,e);var s=new URLSearchParams(n.props.location.search).get("auth");return n.state={authStatus:s,showAuthError:null!==s,redirect:null},n.onGetSpotifyAuth=n.onGetSpotifyAuth.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"onGetSpotifyAuth",value:function(){var e=k.a.get(z,{path:""});if(e){var t=_(e);if(null!==t&&t.refreshToken)return void this.setState({redirect:"/app"})}var a=D.getPKCEAuthUri();window.location=a}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"text-center genify-home splash-gradiant text-white"},s.a.createElement(p.a,{className:"h-100 mx-0"},s.a.createElement(g.a,{className:"my-auto"},s.a.createElement("h1",{style:{fontSize:"3rem",fontWeight:"300"}},"Genify"),s.a.createElement("h4",{style:{fontWeight:"300"},className:"py-2"},"Combining music, lyrics and video"),s.a.createElement(f.a,{className:"spotify-background py-2 px-5",style:{fontSize:"1.25rem",width:"250px"},onClick:this.onGetSpotifyAuth},s.a.createElement(y.a,{icon:b.b,className:"mr-2"}),"Sign In"),s.a.createElement("div",{className:"mx-auto mt-3"},s.a.createElement("a",{href:"https://joshlmao.com",className:"my-auto mr-2 text-white"},"JoshLmao"),s.a.createElement("a",{href:"https://twitter.com/joshlmao"},s.a.createElement(f.a,{className:"py-0 px-2",variant:"outline-light"},s.a.createElement(y.a,{icon:b.c})))))),this.state.authStatus&&s.a.createElement(v.a,{show:this.state.showAuthError,onClose:function(){return e.setState({showAuthError:!1})},className:"mr-2 mb-2 text-left",style:{position:"absolute",bottom:0,right:0,color:"black"}},s.a.createElement(v.a.Header,null,s.a.createElement("strong",{className:"mr-auto"},"A Problem Occured")),s.a.createElement(v.a.Body,null,function(e){switch(e){case"invalid":return"A problem has occured trying to use a previous authorizatino. Please try again";case"expired":return"User's authorization has expired. Please sign in again";case"refresh_error":return"An error occured when attempting to refresh the previous Spotify authorization. Please sign in again";case"state_error":return"The recieved state doesn't match. If you are trying to manipulate the requests, please dont :)";default:return"Unknown error. Sorry, you shouldn't see this"}}(this.state.authStatus))),this.state.redirect&&s.a.createElement(m.a,{to:this.state.redirect}))}}]),a}(n.Component),M=a(460),B=a(462),F=a(458),G=a(211),q=a.n(G),J=a(212),V=a(424),K=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={displayChangelog:!1},n.toggleChangelog=n.toggleChangelog.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"toggleChangelog",value:function(){this.setState({displayChangelog:!this.state.displayChangelog})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"genify-navbar"},s.a.createElement(M.a,{className:"genify-nav-bg",expand:"sm"},s.a.createElement(g.a,null,s.a.createElement(M.a.Brand,{href:"/",className:"text-white"},"Genify"),s.a.createElement(B.a.Link,{className:"p-0 align-bottom mt-1",style:{fontSize:"0.85rem"},href:"",onClick:this.toggleChangelog},V?"v"+V.version:"v0.0.0"),s.a.createElement(M.a.Toggle,{"aria-controls":"basic-navbar-nav"}),s.a.createElement(M.a.Collapse,{id:"basic-navbar-nav"},s.a.createElement(B.a,{className:"ml-auto"},s.a.createElement(B.a.Link,{className:"py-0",href:"https://github.com/JoshLmao/Genify"},s.a.createElement(f.a,{variant:"outline-secondary"},s.a.createElement(y.a,{icon:b.a}))),s.a.createElement(B.a.Link,{className:"py-0",href:"https://twitter.com/JoshLmao"},s.a.createElement(f.a,{variant:"outline-secondary"},s.a.createElement(y.a,{icon:b.c}))))))),this.state.displayChangelog&&s.a.createElement(F.a,{size:"lg",show:this.state.displayChangelog,onHide:function(){return e.toggleChangelog()},className:"changelog-modal"},s.a.createElement(F.a.Header,{closeButton:!0,style:{backgroundColor:"#111",borderColor:"#222"}},s.a.createElement(F.a.Title,{id:"example-modal-sizes-title-lg"},"Changelog")),s.a.createElement(F.a.Body,{className:"changelog-body"},J.logs.map((function(e){return s.a.createElement("div",null,s.a.createElement("h3",null,e.version),s.a.createElement("ul",null,e.changes.map((function(e){return s.a.createElement("li",null,s.a.createElement(q.a,{source:e,className:"no-child-margins"}))}))))}))),s.a.createElement(F.a.Footer,{style:{backgroundColor:"#111",borderColor:"#222"}},s.a.createElement(f.a,{variant:"outline-light",className:"ml-auto",onClick:function(){e.toggleChangelog()}},"Close"))))}}]),a}(n.Component),H=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={redirect:""},n.onReturn=n.onReturn.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"onReturn",value:function(){this.setState({redirect:"/"})}},{key:"render",value:function(){return s.a.createElement(p.a,{className:"w-100 spotify-black genify-home px-0"},s.a.createElement(g.a,{className:"pt-5"},s.a.createElement("h2",{className:"text-center pt-5"},"Error 404: Page Not Found"),s.a.createElement("h6",{className:"text-center"},"\u4f60\u8ff7\u8def\u4e86\u5417\uff1f"),s.a.createElement("div",{className:"py-3"}),s.a.createElement("h5",{className:"mx-auto"},"This page can't be found. Are you sure you typed it in correctly?"),s.a.createElement("div",{className:"mx-auto"},s.a.createElement(f.a,{className:"mx-auto",onClick:this.onReturn,variant:"outline-light"},s.a.createElement(y.a,{icon:A.d,className:"mr-2"}),"Click here to get right back to the music"))),this.state.redirect&&s.a.createElement(m.a,{to:this.state.redirect},"here"))}}]),a}(n.Component),W=a(218),Y=a(459),X=a(219),Z=a(215),$=a(128),Q=a.n($),ee=a(216),te=a.n(ee),ae=a(217),ne=a.n(ae),se="none",ie="english",oe="simplified-chinese",re="traditional-chinese",le="korean",ce="japanese",ue="russian";var he=a(75);function me(e){return e.replace(/^\s+|\s+$/g,"")}function de(e){return(e=function(e){return e.replace(/[^\w\s]/gi,"")}(e=function(e){return e.replace(/\s/g," ")}(e))).toLowerCase()}var pe={search:function(e,t){if(!e)return null;var a=e.item.name.replace(/ *\([^)]*\) */g,""),n=encodeURIComponent("".concat(a," ").concat(e.item.artists[0].name)),s=C+"https://api.genius.com/search?q="+n;P()({method:"GET",url:s,headers:{Authorization:"Bearer "+x},timeout:3e4}).then((function(e){t&&t(e.data)})).catch((function(e){console.error(e)}))},parseLyricsFromUrl:function(e,t){var a=C+e+"?react=1";P()({method:"GET",url:a,headers:{Authorization:"Bearer "+x},timeout:3e4}).then((function(e){if(t){var n="",s=function(e){var t=document.implementation.createHTMLDocument();return t.body.innerHTML=e,t.body}(e.request.responseText);if(s.querySelectorAll(".lyrics").length<=0){var i,o=s.getElementsByTagName("div"),r=Object(he.a)(o);try{for(r.s();!(i=r.n()).done;){var l=i.value,c=l.className.toLowerCase();if(c.includes("lyric")&&c.includes("container"))n+=l.innerHTML.replace(/<br>/g,"\n").replace(/<[^>]*>?/gm,"")}}catch(d){r.e(d)}finally{r.f()}if(n){var u=me(n);t(u)}else console.error("Unable to parse lyrics correctly from page ".concat(a))}else{var h=s.querySelectorAll(".lyrics");if(h.length>0){var m=me(h[0].textContent);t(m)}else console.error("Unable to parse lyrics from old Genius layout")}}})).catch((function(e){console.error(e)}))},getRelevantResult:function(e,t){if(t){if(!(e&&e.length>0))return null;var a,n=Object(he.a)(e);try{for(n.s();!(a=n.n()).done;){var s=a.value,i=de(s.result.primary_artist.name),o=de(s.result.title),r=de(t.name),l=de(t.artists[0].name),c=i.includes(l)&&o.includes(r),u=l.includes(i)&&r.includes(o);if(c||u)return s}}catch(h){n.e(h)}finally{n.f()}}}},ge=(a(445),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(r.a)(this,a),n=t.call(this,e);var s=new X.a;return s.init(new Z.a({dictPath:"./dict"})),n.state={playState:e.playState,originalLyrics:null,romanizedLyrics:null,lyricsSpotifyTrackName:null,lyricsInfo:null,loaded:!0,isRomanized:!1,originalLyricLanguage:se,kuroshiro:s,shouldUpdateLyrics:!0},n.updateLyrics=n.updateLyrics.bind(Object(d.a)(n)),n.onToggleRomanize=n.onToggleRomanize.bind(Object(d.a)(n)),n.resetLyricState=n.resetLyricState.bind(Object(d.a)(n)),n.onRetryLyricsBtn=n.onRetryLyricsBtn.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e){var t=this;e.playState!==this.props.playState&&this.setState({playState:this.props.playState},(function(){var a,n,s;null!==e.playState&&(null===(a=e.playState)||void 0===a||null===(n=a.item)||void 0===n?void 0:n.name)===(null===(s=t.props.playState.item)||void 0===s?void 0:s.name)||t.updateLyrics()}))}},{key:"updateLyrics",value:function(){var e=this;this.state.playState&&this.state.loaded&&(this.setState({loaded:!1,shouldUpdateLyrics:!1,lyricsSpotifyTrackName:null}),pe.search(this.state.playState,(function(t){if(t.response.hits.length>0){var a=pe.getRelevantResult(t.response.hits,e.state.playState.item);a?(console.log("Relevant Result: ".concat(a.result.full_title)),pe.parseLyricsFromUrl(a.result.url,(function(t){console.log("Loaded and set lyrics from ".concat(a.result.url));var n=function(e){var t=se,a=function(e){return e.match(/[\uac00-\ud7af]|[\u1100-\u11ff]|[\u3130-\u318f]|[\ua960-\ua97f]|[\ud7b0-\ud7ff]/g)}(e);null!==a&&(t=le);var n=function(e){return e.match(/[\u3041-\u3093\u30a1-\u30f3]/g)}(e),s=function(e){return e.match(/[\u2E80-\u2FD5\u3190-\u319f\u3400-\u4DBF\u4E00-\u9FCC\uF900-\uFAAD]/g)}(e);null!==n&&null!==s?t=n.length>s.length?ce:oe:null!==n?t=ce:null!==s&&(t="chinese");var i=function(e){return e.match(/^[\u0430\u0410\u0431\u0411\u0432\u0412\u0433\u0413\u0434\u0414\u0435\u0415\u0451\u0401\u0436\u0416\u0437\u0417\u0438\u0418\u0439\u0419\u043a\u041a\u043b\u041b\u043c\u041c\u043d\u041d\u043e\u041e\u043f\u041f\u0440\u0420\u0441\u0421\u0442\u0422\u0443\u0423\u0444\u0424\u0445\u0425\u0446\u0426\u0447\u0427\u0448\u0428\u0449\u0429\u044a\u042a\u044b\u042b\u044c\u042c\u044d\u042d\u044e\u042e\u044f\u042f]+$/)}(e);return null!==i&&(t=ue),"chinese"===t&&(t=oe),null==a&&null==n&&null==s&&null==i&&(t=ie),t}(t);console.log("Original lyrics language: '".concat(n,"'")),e.setState({originalLyrics:t,romanizedLyrics:t,isRomanized:!1,originalLyricLanguage:n,lyricsInfo:a,loaded:!0,lyricsSpotifyTrackName:e.state.playState.item},(function(){var t=function(){var e=k.a.get(U);return e?_(e):null}();t&&t.autoRomanize&&e.state.originalLyricLanguage!==ie&&e.onToggleRomanize()}))}))):(console.log("No related lyrics found out of '".concat(t.response.hits.length,"' results for song '").concat(e.state.playState.item.artists[0].name," - ").concat(e.state.playState.item.name,"'")),e.setState({loaded:!0}),e.resetLyricState())}else console.log("Didn't find any search results on Genius"),e.setState({loaded:!0}),e.resetLyricState()})))}},{key:"resetLyricState",value:function(){this.setState({originalLyrics:null,romanizedLyrics:null,lyricsInfo:null,isRomanized:!1,originalLyricLanguage:se})}},{key:"onToggleRomanize",value:function(){var e=this;if(this.state.originalLyrics){if(this.state.isRomanized)this.setState({romanizedLyrics:this.state.originalLyrics});else{var t="";switch(this.state.originalLyricLanguage){case ce:if(!this.state.kuroshiro)break;t="...",this.state.kuroshiro.convert(this.state.originalLyrics,{to:"romaji",mode:"spaced"}).then((function(t){t=t.replace(/ +(?= )/g,""),e.setState({romanizedLyrics:t})}));break;case oe:case re:t=Q.a.convertToPinyinString(this.state.originalLyrics," ",Q.a.WITH_TONE_MARK);break;case le:t=te.a.romanize(this.state.originalLyrics);break;case ue:t=ne()().transform(this.state.originalLyrics," ")}this.setState({romanizedLyrics:t})}this.setState({isRomanized:!this.state.isRomanized})}}},{key:"onRetryLyricsBtn",value:function(){var e=this;this.state.shouldUpdateLyrics||(this.setState({shouldUpdateLyrics:!0},(function(){return e.updateLyrics()})),console.log("Retrying lyrics at request of user"))}},{key:"render",value:function(){return s.a.createElement("div",{className:"py-2 w-100 h-100"},s.a.createElement("div",{className:"text-center h-100"},!this.state.loaded&&s.a.createElement(y.a,{className:"fa-spin",size:"3x",icon:A.j}),this.state.romanizedLyrics&&this.state.loaded&&s.a.createElement("div",{className:"h-100"},s.a.createElement(W.a,{md:3,sm:3,className:"pr-4 pl-0 mb-2 text-right d-none d-sm-block",style:{height:"35px",position:"absolute",right:0,fontSize:"0.8rem"}},s.a.createElement("h6",{className:"mb-1"},"Lyric Info"),s.a.createElement("a",{href:this.state.lyricsInfo.result.url,className:"py-1"},this.state.lyricsInfo.result.full_title),this.state.originalLyricLanguage!==ie&&s.a.createElement(Y.a,null,s.a.createElement(Y.a.Check,{type:"switch",id:"custom-switch",label:"Romanize",checked:this.state.isRomanized,onChange:this.onToggleRomanize}))),s.a.createElement("div",{className:"lyrics-content"},this.state.romanizedLyrics)),!this.state.originalLyrics&&this.state.loaded&&s.a.createElement("div",{className:"d-flex flex-column"},s.a.createElement("a",{href:"https://genius.com/new"},s.a.createElement(f.a,{variant:"outline-light",className:"mt-2"},"Add to Genius")),s.a.createElement(f.a,{className:"mx-auto my-2",variant:"outline-light",onClick:this.onRetryLyricsBtn},"Retry Lyrics"))))}}]),a}(n.Component)),fe=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={contentSelectedCallback:e.onContentSelected,selections:["lyrics","settings"],selectedSelection:"lyrics"},n.onSelectContent=n.onSelectContent.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"onSelectContent",value:function(e){var t=e.target;this.setState({selectedSelection:t.dataset.tag}),this.state.contentSelectedCallback(t.dataset.tag)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"genify-nav-bg w-100"},s.a.createElement(g.a,{className:"h-100 d-flex align-items-center"},this.state.selections&&this.state.selections.map((function(t,a){return s.a.createElement("div",{onClick:e.onSelectContent,className:"content-selector-item mx-auto ".concat(e.state.selectedSelection===t&&"active-selection"),"data-tag":t,key:t},s.a.createElement("h6",{"data-tag":t,className:"m-0"},t))}))))}}]),a}(n.Component),ve=a(130);function ye(e){return s.a.createElement("div",{className:"d-flex"},s.a.createElement("div",null,e.name),s.a.createElement("div",{className:"ml-auto"},e.check&&s.a.createElement(Y.a,null,s.a.createElement(Y.a.Check,{checked:e.value,type:"switch",id:"testingswitch",label:"","aria-label":e.name,onChange:function(t){e.onCheckToggled&&e.onCheckToggled(t.target.checked)}})),e.value))}var be=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(r.a)(this,a),n=t.call(this,e);var s={autoRomanize:!1},i=k.a.get(U,{path:""});if(i){var o=_(i);o&&(s=o)}else{var l=JSON.stringify(s);k.a.set(U,l,{path:"",expires:365})}return n.state={auth:e.auth,redirect:"",userProfile:null,settings:s},n.onSpotifySignOut=n.onSpotifySignOut.bind(Object(d.a)(n)),n.getLatestUserProfile=n.getLatestUserProfile.bind(Object(d.a)(n)),n.onAutoRomanizeToggled=n.onAutoRomanizeToggled.bind(Object(d.a)(n)),n.onSettingChanged=n.onSettingChanged.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getLatestUserProfile()}},{key:"componentDidUpdate",value:function(e){var t=this;e.auth!==this.props.auth&&this.setState({auth:this.props.auth},(function(){return t.getLatestUserProfile()}))}},{key:"onSettingChanged",value:function(){var e=JSON.stringify(this.state.settings);k.a.set(U,e,{path:"",expires:365})}},{key:"getLatestUserProfile",value:function(){var e=this;this.state.auth&&D.getCurrentUserProfile(this.state.auth.authToken,(function(t){e.setState({userProfile:t})}))}},{key:"onSpotifySignOut",value:function(){console.log("Signing out of Genify"),k.a.get(z)&&k.a.set(z,"",{path:"",expires:365}),this.setState({redirect:"/"})}},{key:"onAutoRomanizeToggled",value:function(e){var t=this;this.setState({settings:Object(ve.a)(Object(ve.a)({},this.state.settings),{},{autoRomanize:e})},(function(){t.onSettingChanged()}))}},{key:"render",value:function(){var e,t,a,n,i,o,r,l,c,u,h,d,p,v,E,k,S,x;return s.a.createElement("div",{className:"w-100 h-100"},s.a.createElement(g.a,{className:"py-2 px-5 scrollable-main-content"},s.a.createElement("h2",{className:"mb-4"},"App Settings"),s.a.createElement("h5",null,"Spotify"),s.a.createElement("div",{className:"d-flex px-3 my-3"},s.a.createElement("img",{alt:"Signed in user icon",src:null!==(e=null===(t=this.state.userProfile)||void 0===t||null===(a=t.images[0])||void 0===a?void 0:a.url)&&void 0!==e?e:"https://via.placeholder.com/50",style:{maxHeight:"50px",maxWidth:"50px"}}),s.a.createElement("div",{className:"px-3"},s.a.createElement("h6",null,null!==(n=null===(i=this.state.userProfile)||void 0===i?void 0:i.display_name)&&void 0!==n?n:"No Display Name"),s.a.createElement("h6",{style:{color:"rgb(200, 200, 200)",fontSize:"0.8rem"}},(null===(o=this.state.userProfile)||void 0===o?void 0:o.product)?"SPOTIFY "+(null===(r=this.state.userProfile)||void 0===r?void 0:r.product.toUpperCase()):"UNKNOWN")),s.a.createElement("a",{href:null===(l=this.state.userProfile)||void 0===l||null===(c=l.external_urls)||void 0===c?void 0:c.spotify,target:"noopener",className:"ml-auto"},s.a.createElement(f.a,{variant:"outline-success"},s.a.createElement(y.a,{icon:A.o})))),s.a.createElement(ye,{name:"Account Id",value:null!==(u=null===(h=this.state.userProfile)||void 0===h?void 0:h.id)&&void 0!==u?u:"Unknown"}),s.a.createElement(ye,{name:"Followers",value:null!==(d=null===(p=this.state.userProfile)||void 0===p||null===(v=p.followers)||void 0===v?void 0:v.total)&&void 0!==d?d:"Unknown"}),s.a.createElement(ye,{name:"Region",value:null!==(E=null===(k=this.state.userProfile)||void 0===k?void 0:k.country)&&void 0!==E?E:"Antarctica"}),s.a.createElement("div",{className:"w-100 text-right my-2"},s.a.createElement(f.a,{variant:"success",onClick:this.onSpotifySignOut,className:"px-4"},s.a.createElement(y.a,{className:"mr-2",icon:b.b}),"Sign Out")),s.a.createElement("div",{className:"pt-3"},s.a.createElement(ye,{name:"Enable Web Playback",value:"Coming soon..."})),s.a.createElement("div",{className:"horizontal-separator"}),s.a.createElement("h5",null,"Language"),s.a.createElement(ye,{name:"Automatically romanize Chinese/Japanese/Korean/Russian",value:null!==(S=null===(x=this.state.settings)||void 0===x?void 0:x.autoRomanize)&&void 0!==S&&S,check:!0,onCheckToggled:this.onAutoRomanizeToggled}),s.a.createElement("div",{className:"horizontal-separator"}),s.a.createElement("h4",null,"Credits"),s.a.createElement("div",{className:"d-flex mb-2"},s.a.createElement("p",{className:"my-0"},"Created By"),s.a.createElement("div",{className:"ml-auto d-flex"},s.a.createElement("a",{href:"https://joshlmao.com",className:"mx-2"},s.a.createElement("p",{className:"my-0"},"JoshLmao")),s.a.createElement("a",{href:"https://github.com/JoshLmao",target:"noopener",className:"mx-2"},s.a.createElement(y.a,{icon:b.a})),s.a.createElement("a",{href:"https://twitter.com/JoshLmao",target:"noopener",className:"mx-2"},s.a.createElement(y.a,{icon:b.c})))),s.a.createElement("p",null,"If you enjoy this app, please consider supporting me through one of the options below. If not, thank you for using and enjoying the app! ",s.a.createElement("span",{role:"img","aria-label":"hug emoji"},"\ud83e\udd17")),s.a.createElement("div",{className:"w-100 text-center"},s.a.createElement("iframe",{className:"mx-auto",title:"spotify follow joshlmao",src:"https://open.spotify.com/follow/1/?uri=spotify:user:1121645175&size=detail&theme=dark",width:"300",height:"56",scrolling:"no",frameborder:"0",style:{border:"none",overflow:"hidden"},allowtransparency:"true"})),s.a.createElement("p",{className:"text-center"},s.a.createElement("a",{href:"https://github.com/sponsors/JoshLmao",className:"m-2"},s.a.createElement("img",{alt:"Github Sponsor Advert",src:"/img/github-sponsor.png",className:"my-2",height:"50px"})),s.a.createElement("a",{href:"https://brave.com/jos677",className:"m-2"},s.a.createElement("img",{alt:"Brave Browser advert",src:"/img/BraveBat.png",className:"my-2",style:{height:"40px"}})),s.a.createElement("a",{href:"https://paypal.me/xjoshlmao",className:"m-2"},s.a.createElement("img",{alt:"Paypal Donation Advert",src:"https://i.imgur.com/UfSd0gP.png",className:"my-2",style:{height:"50px"}})))),this.state.redirect&&s.a.createElement(m.a,{to:this.state.redirect}))}}]),a}(n.Component),Ee=a(129),ke=a.n(Ee),Se=a(463),xe=a(464),Ce=a(465),Ne=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={devices:e.devices,auth:e.auth,showDevicesPopover:!1,popoverLocationTarget:null},n.onSelectPlaybackDevice=n.onSelectPlaybackDevice.bind(Object(d.a)(n)),n.handleDisplayDeviceSelector=n.handleDisplayDeviceSelector.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e){e.devices!==this.props.devices&&this.setState({devices:this.props.devices}),e.auth!==this.props.auth&&this.setState({auth:this.props.auth})}},{key:"handleDisplayDeviceSelector",value:function(e){this.setState({showDevicesPopover:!this.state.showDevicesPopover,popoverLocationTarget:e.target})}},{key:"onSelectPlaybackDevice",value:function(e){var t=e.target.dataset.deviceid;D.setPlaybackDevice(this.state.auth.authToken,t,!0),this.state.devices.find((function(e){return!0===e.is_active})).is_active=!1,this.state.devices.find((function(e){return e.id===t})).is_active=!0}},{key:"render",value:function(){var e=this;return s.a.createElement(Se.a,{placement:"bottom",trigger:"focus",overlay:s.a.createElement(xe.a,Object.assign({id:"devices-popover",className:"genify-light-background"},this.props),s.a.createElement(xe.a.Title,{as:"h3",className:"playback-devices-title text-center"},"Connect to a device"),s.a.createElement(xe.a.Content,null,s.a.createElement(Ce.a,{variant:"flush"},this.state.devices&&this.state.devices.map((function(t,a){return s.a.createElement(Ce.a.Item,{action:!0,onClick:e.onSelectPlaybackDevice,key:t.id,className:"playback-device-item ".concat(t.is_active?"active-device":""),"data-deviceid":t.id},s.a.createElement(y.a,{icon:L(t.type),className:"mr-2"}),t.name)})),!this.state.devices&&s.a.createElement(y.a,{className:"mx-auto text-white",size:"2x",icon:A.j,spin:!0}))))},s.a.createElement(f.a,{variant:"outline-light",onClick:this.handleDisplayDeviceSelector},s.a.createElement(y.a,{icon:A.b})))}}]),a}(n.Component);function Pe(e){var t=(e/1e3).toFixed(0),a=Math.floor(t/60),n="";return a>59&&(a=(a-=60*(n=(n=Math.floor(a/60))>=10?n:"0"+n))>=10?a:"0"+a),t=(t=Math.floor(t%60))>=10?t:"0"+t,""!==n?n+":"+a+":"+t:a+":"+t}function we(e){var t="https://via.placeholder.com/75";e&&(e.item.album&&e.item.album.images.length>0&&(t=e.item.album.images[0].url));return t}var je=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n,s;return Object(r.a)(this,a),(s=t.call(this,e)).state={auth:e.auth,playState:e.playState,volumePercent:e.playState?null===(n=e.playState.device)||void 0===n?void 0:n.volume_percent:0,trackProgressMs:e.playState?e.playState.progress_ms:0,isChangingTrackProgress:!1},s.onPlayPause=s.onPlayPause.bind(Object(d.a)(s)),s.onNextTrack=s.onNextTrack.bind(Object(d.a)(s)),s.onPreviousTrack=s.onPreviousTrack.bind(Object(d.a)(s)),s.onToggleVolumeMute=s.onToggleVolumeMute.bind(Object(d.a)(s)),s.onVolumeChanged=s.onVolumeChanged.bind(Object(d.a)(s)),s.onFinishVolumeChanged=s.onFinishVolumeChanged.bind(Object(d.a)(s)),s.onProgressChanged=s.onProgressChanged.bind(Object(d.a)(s)),s.onFinishProgressChanged=s.onFinishProgressChanged.bind(Object(d.a)(s)),s.updatePlaybackDevices=s.updatePlaybackDevices.bind(Object(d.a)(s)),s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;setInterval((function(){e.updatePlaybackDevices()}),3e3)}},{key:"componentDidUpdate",value:function(e){var t,a,n;e.playState!==this.props.playState&&this.setState({playState:this.props.playState,volumePercent:null===(t=this.props.playState)||void 0===t||null===(a=t.device)||void 0===a?void 0:a.volume_percent,trackProgressMs:null===(n=this.props.playState)||void 0===n?void 0:n.progress_ms});e.auth!==this.props.auth&&this.setState({auth:this.props.auth})}},{key:"onPlayPause",value:function(){this.state.playState&&(this.state.playState.is_playing?D.pause(this.state.auth.authToken):D.play(this.state.auth.authToken))}},{key:"onNextTrack",value:function(){D.nextTrack(this.state.auth.authToken)}},{key:"onPreviousTrack",value:function(){D.previousTrack(this.state.auth.authToken)}},{key:"onToggleVolumeMute",value:function(){var e;this.state.playState&&((null===(e=this.state.playState.device)||void 0===e?void 0:e.volume_percent)>0?D.setVolume(this.state.auth.authToken,0):D.setVolume(this.state.auth.authToken,25))}},{key:"onVolumeChanged",value:function(e){this.setState({volumePercent:parseInt(e.target.value)})}},{key:"onFinishVolumeChanged",value:function(){var e;this.state.volumePercent!==(null===(e=this.state.playState.device)||void 0===e?void 0:e.volume_percent)&&(console.log("Web API: Set volume to "+this.state.volumePercent),D.setVolume(this.state.auth.authToken,this.state.volumePercent))}},{key:"onProgressChanged",value:function(e){this.setState({trackProgressMs:parseInt(e.target.value)}),this.state.isChangingTrackProgress||this.setState({isChangingTrackProgress:!0})}},{key:"onFinishProgressChanged",value:function(){this.state.playState&&this.state.playState.progress_ms!==this.state.trackProgressMs&&D.seek(this.state.auth.authToken,this.state.trackProgressMs),this.setState({isChangingTrackProgress:!1})}},{key:"updatePlaybackDevices",value:function(){var e,t=this;D.getPlaybackDevices(null===(e=this.state.auth)||void 0===e?void 0:e.authToken,(function(e){var a=e.devices.sort((function(e,t){var a=e.name.toUpperCase(),n=t.name.toUpperCase();return a<n?-1:a>n?1:0})).sort((function(e,t){return e.is_active?-1:t.is_active?1:0}));t.setState({playbackDevices:a})}))}},{key:"render",value:function(){var e,t,a,n,i,o,r,l,c,u;return s.a.createElement(p.a,{className:"w-100 mx-0 genify-player"},s.a.createElement(W.a,{xl:3,lg:3,md:4,sm:5,xs:12},s.a.createElement("div",{className:"d-flex align-items-center my-auto"},this.state.playState&&s.a.createElement("a",{href:this.state.playState?null===(e=this.state.playState.item)||void 0===e||null===(t=e.album)||void 0===t||null===(a=t.external_urls)||void 0===a?void 0:a.spotify:"#",className:"ml-2 p-2"},s.a.createElement("img",{className:"album-art",alt:this.state.playState?(null===(n=this.state.playState.item)||void 0===n?void 0:n.artists[0].name)+"Album Art":"Unknown Album",src:we(this.state.playState),style:{maxWidth:"75px",maxHeight:"75px"}})),s.a.createElement("div",{className:"w-100 ml-2 song-info"},s.a.createElement("a",{href:this.state.playState?null===(i=this.state.playState.item)||void 0===i||null===(o=i.external_urls)||void 0===o?void 0:o.spotify:"#"},s.a.createElement("h6",null,this.state.playState?null===(r=this.state.playState.item)||void 0===r?void 0:r.name:"")),s.a.createElement("h6",null,this.state.playState?function(e){var t;if(!e)return null;var a=null===(t=e.item)||void 0===t?void 0:t.artists;return a?s.a.createElement("div",{className:"d-flex"},a.map((function(e,t){return s.a.createElement("div",{className:"d-flex",key:e.name},s.a.createElement("a",{href:e.external_urls.spotify},e.name),t<a.length-1&&s.a.createElement("div",{className:"pr-1"}," ,"))}))):null}(this.state.playState):""))),!this.state.playState&&s.a.createElement("div",{className:"my-auto"},s.a.createElement("h6",null,"No song currently playing."),s.a.createElement("h6",null,"Play a song to get started!"))),s.a.createElement(W.a,{xl:6,lg:6,md:5,sm:7,className:"d-none d-sm-block my-auto"},s.a.createElement("div",{className:"d-flex align-items-center my-1"},s.a.createElement("div",{className:"mx-auto my-1"},s.a.createElement(f.a,{className:"mx-2",variant:"outline-light",onClick:this.onPreviousTrack},s.a.createElement(y.a,{icon:A.k})),s.a.createElement(f.a,{className:"mx-2",variant:"outline-light",onClick:this.onPlayPause},s.a.createElement(y.a,{icon:(null===(l=this.state.playState)||void 0===l?void 0:l.is_playing)?A.g:A.h})),s.a.createElement(f.a,{className:"mx-2",variant:"outline-light",onClick:this.onNextTrack},s.a.createElement(y.a,{icon:A.l})))),s.a.createElement("div",{className:"d-flex align-items-center my-1"},s.a.createElement("h6",{className:"my-auto mx-2"},this.state.playState&&Pe(this.state.isChangingTrackProgress?this.state.trackProgressMs:this.state.playState.progress_ms),!this.state.playState&&"0:00"),s.a.createElement("div",{className:"w-100",onMouseUp:this.onFinishProgressChanged},s.a.createElement(ke.a,{value:this.state.trackProgressMs,min:0,max:this.state.playState?null===(c=this.state.playState.item)||void 0===c?void 0:c.duration_ms:100,onChange:this.onProgressChanged,tooltip:"off"})),s.a.createElement("h6",{className:"my-auto mx-2"},this.state.playState&&Pe(null===(u=this.state.playState.item)||void 0===u?void 0:u.duration_ms),!this.state.playState&&"9:59"))),s.a.createElement(W.a,{xl:3,lg:3,md:3,className:"d-none d-md-block my-auto"},s.a.createElement("div",{className:"d-flex align-items-center"},s.a.createElement(Ne,{devices:this.state.playbackDevices,auth:this.state.auth}),s.a.createElement(f.a,{className:"mx-2",variant:"outline-light",onClick:this.onToggleVolumeMute},s.a.createElement(y.a,{icon:0===this.state.volumePercent?A.p:A.q})),s.a.createElement("div",{onMouseUp:this.onFinishVolumeChanged,className:"w-100"},s.a.createElement(ke.a,{value:this.state.volumePercent,onChange:this.onVolumeChanged,tooltip:"auto",variant:"primary"})))))}}]),a}(n.Component),Oe=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(r.a)(this,a),n=t.call(this,e);var s="",i=null,o=!1;return null===(i=_(k.a.get(z)))?(s="/?auth=invalid",console.log("No auth in cookies or corrupted, going home")):(i.expireDate=new Date(i.expireDate),i.expireDate<Date.now()?i.refreshToken?(console.log("Auth expired at '".concat(i.expireDate.toLocaleString(),"'. Using refreshToken to get new auth")),o=!0,n.refreshAuth(i.refreshToken)):(k.a.remove(z),s="/?auth=expired",console.log("Auth found but has expired")):console.log("Auth found. Expires at '".concat(i.expireDate.toLocaleString(),"'"))),n.state={auth:i,isRefreshingAuth:o,refreshAuthRoutine:null,spotifyUpdateRoutine:null,infoMessage:"",showInfoMessage:!1,redirect:s,mainContentPanel:"lyrics"},n.initService=n.initService.bind(Object(d.a)(n)),n.refreshAuth=n.refreshAuth.bind(Object(d.a)(n)),n.onContentPanelSelected=n.onContentPanelSelected.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){null!==this.state.auth||this.state.isRefreshingAuth||this.setState({redirect:"/?auth=invalid"}),null===this.state.auth||this.state.isRefreshingAuth||this.initService()}},{key:"initService",value:function(){var e=this;if(D.getCurrentPlaybackState(this.state.auth.authToken,(function(t){e.setState({playState:t,loaded:!0})})),!this.state.spotifyUpdateRoutine){var t=setInterval((function(){var t;null===(t=e.state.auth)||null!=t&&t.expireDate<Date.now()||D.getCurrentPlaybackState(e.state.auth.authToken,(function(t){var a,n,s;(null===(a=t.item)||void 0===a?void 0:a.name)!==(null===(n=e.state.playState.item)||void 0===n?void 0:n.name)&&console.log("TRACK CHANGED | ".concat(t.item.artists[0].name," - ").concat(null===(s=t.item)||void 0===s?void 0:s.name));e.setState({playState:t})}))}),2e3);this.setState({updateRoutine:t})}if(!this.state.refreshAuthRoutine){var a=this.state.auth.expireDate-new Date(Date.now()),n=setTimeout((function(){console.log("Auth will expire in ".concat(3," minute(s). Refreshing...")),e.setState({refreshAuthRoutine:null}),e.refreshAuth(e.state.auth.refreshToken)}),a-18e4);this.setState({refreshAuthRoutine:n})}}},{key:"refreshAuth",value:function(e){var t=this;this.setState({isRefreshingAuth:!0}),D.refreshAuth(e,(function(e){var a=D.parseAuth(e);if(a){console.log("Successfully refreshed auth. Expires at '".concat(a.expireDate.toLocaleString(),"'"));var n=JSON.stringify(a);k.a.set(z,n,{path:"",expires:365})}else console.error("Error when trying to refresh auth"),k.a.remove(z),t.setState({redirect:"/?auth=refresh_error"});t.setState({isRefreshingAuth:!1,auth:a},(function(){t.initService()}))}))}},{key:"onContentPanelSelected",value:function(e){e!==this.state.mainContentPanel&&this.setState({mainContentPanel:e})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"genify-home genify-dark-background"},s.a.createElement(p.a,{className:"mx-0"},s.a.createElement(je,{playState:this.state.playState,auth:this.state.auth})),s.a.createElement("div",{className:"main-content-container"},s.a.createElement(p.a,{className:"content-nav mx-0"},s.a.createElement(fe,{onContentSelected:this.onContentPanelSelected})),s.a.createElement(p.a,{className:"focused-content-container mx-0"},s.a.createElement("div",{className:"w-100 h-100 "+("lyrics"===this.state.mainContentPanel?"d-block":"d-none")},s.a.createElement(ge,{playState:this.state.playState})),s.a.createElement("div",{className:"w-100 h-100 "+("settings"===this.state.mainContentPanel?"d-block":"d-none")},s.a.createElement(be,{auth:this.state.auth})))),this.state.infoMessage&&s.a.createElement(v.a,{show:this.state.showInfoMessage,onClose:function(){return e.setState({showInfoMessage:!1})},className:"mr-2 mb-2 text-left",style:{position:"absolute",bottom:0,right:0,color:"black"}},s.a.createElement(v.a.Header,null,s.a.createElement("strong",{className:"mr-auto"},"Info")),s.a.createElement(v.a.Body,null,this.state.infoMessage)),this.state.redirect&&s.a.createElement(m.a,{to:this.state.redirect}))}}]),a}(n.Component),Te=(a(447),a(448),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n,s;Object(r.a)(this,a),s=t.call(this,e);var i={};if(null===(n=e.location)||void 0===n?void 0:n.search){var o=e.location.search.substring(1).split("&");if(o.length<=2){var l,c=Object(he.a)(o);try{for(c.s();!(l=c.n()).done;){var u=l.value,h=u.split("=");u.includes("code")?i.code=h[1]:u.includes("state")?i.state=h[1]:u.includes("error")&&(i.error=h[1])}}catch(m){c.e(m)}finally{c.f()}}}return s.state={exchangeData:i,redirect:null},s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;if(this.state.exchangeData){if(this.state.exchangeData.state&&"genify-app"===!this.state.exchangeData.state)return console.error("Spotify state doesn't match returned state"),void this.setState({redirect:"/?auth=state_error"});D.exchangePKCECode(this.state.exchangeData.code,(function(t){var a=D.parseAuth(t);if(a){var n=JSON.stringify(a);k.a.set(z,n,{path:"",expires:365}),console.log("Successfully saved auth! Redirecting..."),setTimeout((function(){e.setState({redirect:"/app"})}),100)}else console.error("Unable to parse and save auth")}))}}},{key:"render",value:function(){return s.a.createElement("div",{className:"h-100 w-100 spotify-black"},s.a.createElement("h3",{className:"text-center pt-5"},"Redirecting..."),s.a.createElement("div",{className:"mx-auto",style:{width:"50px"}},s.a.createElement(y.a,{className:"fa-spin",size:"3x",icon:A.j})),this.state.redirect&&s.a.createElement(m.a,{to:this.state.redirect}))}}]),a}(n.Component)),Ae=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return s.a.createElement(h.a,{basename:""},s.a.createElement(K,null),s.a.createElement(m.d,null,s.a.createElement(m.b,{exact:!0,path:"/",component:I}),s.a.createElement(m.b,{exact:!0,path:"/app",component:Oe}),s.a.createElement(m.b,{exact:!0,path:"/callback",component:Te}),s.a.createElement(m.b,{component:H})))}}]),a}(n.Component),Re=(a(449),s.a.createElement(s.a.StrictMode,null,s.a.createElement(Ae,null)));o.a.render(Re,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[221,1,2]]]);
//# sourceMappingURL=main.5585c3c0.chunk.js.map