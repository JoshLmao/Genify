{"version":3,"sources":["serviceWorker.js","consts.js","helpers/spotifyHelper.js","services/spotify.js","enums/cookies.js","components/Home/index.js","components/Home/Home.jsx","components/Navigation/Navigation.jsx","components/Navigation/index.js","components/FourOhFour/index.js","components/FourOhFour/FourOhFour.jsx","helpers/languageHelper.js","helpers/filterHelper.js","services/genius.js","components/Lyrics/Lyrics.jsx","components/ContentSelector/index.js","components/ContentSelector/ContentSelector.jsx","components/Settings/Settings.jsx","components/Settings/index.js","components/Player/DevicesPopover.jsx","components/Player/Player.jsx","components/Player/index.js","components/Service/index.js","components/Service/Service.jsx","components/Callback/Callback.jsx","components/App/index.js","components/App/App.jsx","index.js"],"names":["Boolean","window","location","hostname","match","SPOTIFY_CODE_VERIFIER","GENIUS_ACCESS_TOKEN","PROXY_URL","urlEncodeData","data","formBody","property","encodedKey","encodeURIComponent","encodedValue","push","join","deviceTypeToIcon","deviceType","toLowerCase","faTv","faLaptop","faQuestion","SpotifyService","getPKCEAuthUri","redirectUri","baseUrl","scopesEncoded","challenge","this","encodePKCEChallenge","codeChallengeMethod","method","codeChallenge","endpoint","verifier","sha","sha256","Base64","stringify","replace","exchangePKCECode","pkceCode","authCallback","encodedBody","grant_type","client_id","code","redirect_uri","code_verifier","axios","url","headers","timeout","then","result","catch","error","console","response","parseAuth","expiresSeconds","expires_in","authExpireTime","getAuthExpireTime","scopes","scope","split","authToken","access_token","tokenType","token_type","refreshToken","refresh_token","expireDate","refreshAuth","encodedData","handleApiError","apiPath","message","seconds","Date","now","makeApiRequest","callback","makeApiDataRequest","getCurrentPlaybackState","apiToken","pause","play","previousTrack","nextTrack","setVolume","volume","seek","positionMs","getPlaybackDevices","setPlaybackDevice","targetDevice","reqData","device_ids","getCurrentUserProfile","EGenifyCookieNames","Home","props","authStatus","URLSearchParams","search","get","state","showAuthError","redirect","onGetSpotifyAuth","bind","prevAuthStr","Cookies","path","prevAuth","JSON","parse","setState","e","className","Row","Container","style","fontSize","fontWeight","Button","width","onClick","icon","faSpotify","href","variant","faTwitter","Toast","show","onClose","position","bottom","right","color","Header","Body","getAuthMessage","to","Component","pkg","require","Navigation","displayChangelog","toggleChangelog","Navbar","expand","Brand","Nav","Link","version","Toggle","aria-controls","Collapse","id","faGithub","Modal","size","onHide","closeButton","backgroundColor","borderColor","Title","changelogs","logs","map","log","changes","change","source","Footer","FourOhFour","onReturn","faHome","ELanguages","filterStartEndSpaceChars","str","processString","filterSpecialChars","filterSpecialSpace","GeniusService","playData","filteredTitle","item","name","searchTerm","artists","geniusUrl","parseLyricsFromUrl","allLyrics","html","tmp","document","implementation","createHTMLDocument","body","innerHTML","parseHTML","request","responseText","querySelectorAll","length","allDivs","getElementsByTagName","div","lowercase","includes","filteredLyrics","filtered","textContent","getRelevantResult","hits","trackInfo","hit","geniusArtist","primary_artist","geniusTrackName","title","spotifyTrackName","spotifyFirstArtistName","geniusIncludes","spotifyIncludes","Lyrics","kuroshiro","Kuroshiro","init","KuromojiAnalyzer","dictPath","playState","originalLyrics","romanizedLyrics","lyricsSpotifyTrackName","lyricsInfo","loaded","isRomanized","originalLyricLanguage","shouldUpdateLyrics","updateLyrics","onToggleRomanize","resetLyricState","onRetryLyricsBtn","prevProps","info","full_title","lyrics","origLyricLang","lang","koreanChars","getKoreanChars","japaneseChars","getJapaneseChars","chineseChars","getChineseChars","russianChars","getRussianChars","determineLanguage","convert","mode","romajiLyrics","pinyin4js","convertToPinyinString","WITH_TONE_MARK","Aromanize","romanize","cyrillicToTranslit","transform","faSpinner","Col","md","sm","height","Form","Check","type","label","onChange","ContentSelector","contentSelectedCallback","onContentSelected","selections","selectedSelection","onSelectContent","event","target","dataset","tag","value","index","data-tag","key","SettingNameValue","Settings","auth","userProfile","onSpotifySignOut","profileData","set","expires","alt","src","images","maxHeight","maxWidth","display_name","product","toUpperCase","external_urls","spotify","followers","total","country","role","aria-label","DevicesPopover","devices","showDevicesPopover","popoverLocationTarget","onSelectPlaybackDevice","handleDisplayDeviceSelector","deviceId","deviceid","find","x","is_active","OverlayTrigger","placement","trigger","overlay","Popover","as","Content","ListGroup","Item","action","data-deviceid","spin","faDesktop","msToTime","millisec","toFixed","minutes","Math","floor","hours","retrieveAlbumArt","album","Player","volumePercent","device","volume_percent","trackProgressMs","progress_ms","isChangingTrackProgress","onPlayPause","onNextTrack","onPreviousTrack","onToggleVolumeMute","onVolumeChanged","onFinishVolumeChanged","onProgressChanged","onFinishProgressChanged","updatePlaybackDevices","setInterval","is_playing","changedEvent","parseInt","sortedDevices","sort","y","xName","yName","playbackDevices","xl","lg","xs","allArtists","getFormattedArtists","faStepBackward","faPause","faPlay","faStepForward","onMouseUp","min","max","duration_ms","tooltip","faVolumeMute","faVolumeUp","Service","isRefreshing","authStringified","toLocaleString","remove","isRefreshingAuth","refreshAuthRoutine","spotifyUpdateRoutine","infoMessage","showInfoMessage","mainContentPanel","initService","onContentPanelSelected","updateRoutine","expireMs","setTimeout","SPOTIFY_REFRESH_MINUTES","refreshedAuth","stringified","panel","Callback","exchangeData","substring","keyValue","kvSplit","authData","App","basename","process","exact","component","app","StrictMode","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.a19913a1.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","/// Social Links\r\n/// Twitter\r\nexport const TWITTER_LINK = \"https://twitter.com/JoshLmao\";\r\n/// Repository github link\r\nexport const GITHUB_LINK = \"https://github.com/JoshLmao/Genify\";\r\n\r\n\r\n/* Spotify API & related params */\r\n/// Client ID required for Spotify auth\r\nexport const SPOTIFY_CLIENT_ID = \"f4dc97c399124fc99254c5d7ac2bf4bd\";\r\n/// A code verifier for the PKCE auth method\r\n/// https://tonyxu-io.github.io/pkce-generator/\r\nexport const SPOTIFY_CODE_VERIFIER = \"dZ7Y5s8PMg_oljOH1DgF_PDXXp-GvzF3g1OMlXh08Af~5J5hosQPQ4eNILnSf3IK.SKtnWlgANdHC.1.wSBw0ZqxtxBRsD7vkGV_f67RBa4DoFo0O3mrz5wB-3e17TsK\";\r\n\r\n\r\n/* Genius API */\r\n/// Access token for using Genius web api\r\nexport const GENIUS_ACCESS_TOKEN = \"jZPEvjdl6Sk1RJUDoo0tTuEFYv2B8rbosLsOUnFBqbi11dCtfftjiN911-a9q0lo\";\r\n\r\n\r\n/// Time in ms for all web requests with no response to timeout\r\nexport const REQUEST_TIMEOUT_MS = 30000;\r\n/// Time in ms that the Spotify player updates its play state\r\nexport const PLAYER_UPDATE_MS = 2000;\r\n/// Time in minutes to refresh the user auth before it expires\r\nexport const SPOTIFY_REFRESH_MINUTES = 3;\r\n\r\n/// Proxy URL to use to aviod CORS issue\r\nexport const PROXY_URL = \"https://genify-proxy.herokuapp.com/\";\r\n/// Mirror Homepage property in package.json. Used in services when can't access it\r\nexport const HOMEPAGE = \"https://genify.joshlmao.com\";","import React from 'react';\r\nimport { \r\n    faQuestion,\r\n    faTv, \r\n    faLaptop\r\n} from '@fortawesome/free-solid-svg-icons';\r\n\r\n// Gets a formatted string of all artists on one track, separated with a comma and correct hyperlinking\r\n// For example \"Enter Shikari, TWICE, KSI\"\r\nexport function getFormattedArtists (playState) {\r\n    if (!playState) {\r\n        return null;\r\n    }\r\n\r\n    let allArtists = playState.item?.artists;\r\n    if (allArtists) {\r\n        return (\r\n            <div className=\"d-flex\">\r\n                {\r\n                    allArtists.map((value, index) => {\r\n                        return (\r\n                        <div className=\"d-flex\" key={value.name}>\r\n                            <a  href={value.external_urls.spotify}>{value.name}</a> \r\n                            { index < allArtists.length - 1 && <div className=\"pr-1\"> ,</div> }\r\n                        </div>\r\n                        )\r\n                    })\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n    return null;\r\n}\r\n\r\n/// Encodes the data into application/x-www-form-urlencoded for POST requests\r\n/// https://stackoverflow.com/a/37562814/11593118\r\nexport function urlEncodeData(data) {\r\n    var formBody = [];\r\n    for (var property in data) {\r\n        var encodedKey = encodeURIComponent(property);\r\n        var encodedValue = encodeURIComponent(data[property]);\r\n        formBody.push(encodedKey + \"=\" + encodedValue);\r\n    }\r\n    formBody = formBody.join(\"&\");\r\n    return formBody;\r\n}\r\n\r\n/// Checks if the current auth is invalid, null or expired\r\nexport function hasAuthExpired(auth) {\r\n    return auth === null || (auth != null && auth.expireDate < Date.now());\r\n}\r\n\r\n/// Returns a font awesome icon related to the type of playback device\r\nexport function deviceTypeToIcon (deviceType) {\r\n    switch(deviceType.toLowerCase()) {\r\n        case \"tv\":\r\n            return faTv;\r\n        case \"computer\":\r\n            return faLaptop;\r\n        default:\r\n            return faQuestion;\r\n    }\r\n}","import {\r\n    SPOTIFY_CLIENT_ID,\r\n    SPOTIFY_CODE_VERIFIER,\r\n    SPOTIFY_REFRESH_MINUTES,\r\n    REQUEST_TIMEOUT_MS,\r\n    PROXY_URL,\r\n    HOMEPAGE,\r\n} from \"../consts\";\r\nimport {\r\n    isDev\r\n} from \"../helpers/devHelper\";\r\nimport axios from \"axios\";\r\nimport sha256 from 'crypto-js/sha256';\r\nimport Base64 from 'crypto-js/enc-base64';\r\nimport { urlEncodeData } from \"../helpers/spotifyHelper\";\r\n\r\nconst SpotifyService = {\r\n    /// Generates an Spotify auth uri for the PKCE auth flow\r\n    /// https://developer.spotify.com/documentation/general/guides/authorization-guide/#authorization-code-flow-with-proof-key-for-code-exchange-pkce\r\n    getPKCEAuthUri: function () {\r\n        let responseType = \"code\";\r\n        let baseUrl = isDev() ? \"http://localhost:3000\" : HOMEPAGE;\r\n        let redirectUri = encodeURIComponent(baseUrl + \"/callback\");\r\n        let scopes = [\r\n            'streaming',\r\n            'user-read-currently-playing',\r\n            'user-read-playback-state',\r\n            'user-modify-playback-state',\r\n            'app-remote-control',\r\n            'user-read-email',\r\n            'user-read-private',\r\n        ];\r\n        let scopesEncoded = encodeURIComponent(scopes.join(' '));\r\n        \r\n        let challenge = this.encodePKCEChallenge(SPOTIFY_CODE_VERIFIER);\r\n        let codeChallengeMethod = challenge.method;\r\n        let codeChallenge = challenge.challenge;\r\n\r\n        let appState = \"jhkmsdgfiudf3243\";\r\n        let params = [\r\n            `response_type=${responseType}`,\r\n            `client_id=${SPOTIFY_CLIENT_ID}`,\r\n            `redirect_uri=${redirectUri}`,\r\n            `code_challenge=${codeChallenge}`,\r\n            `code_challenge_method=${codeChallengeMethod}`,\r\n            `state=${appState}`,\r\n            `scope=${scopesEncoded}`,\r\n        ];\r\n\r\n        let endpoint = \"https://accounts.spotify.com/authorize\";\r\n        return endpoint + \"?\" + params.join(\"&\");\r\n    },\r\n\r\n    /// Encodes a code verifier into a code challenge using SHA256, encoded into base64\r\n    encodePKCEChallenge: function (verifier) {\r\n        let sha = sha256(verifier);\r\n        let base64 = Base64.stringify(sha).replace(/=/g, '').replace(/\\+/g, '-').replace(/\\//g, '_');\r\n        return {\r\n            method: \"S256\",\r\n            challenge: base64,\r\n        };\r\n    },\r\n\r\n    /// Exchanges the PKCE code and responds with relevant encoded data\r\n    /// Callback for handling recieving final Spotify auth\r\n    exchangePKCECode: function (pkceCode, authCallback) {\r\n        let baseUrl = isDev() ? \"http://localhost:3000\" : HOMEPAGE;\r\n        let redirectUri = baseUrl + \"/callback\";\r\n\r\n        let encodedBody = urlEncodeData({\r\n            grant_type: encodeURIComponent('authorization_code'),\r\n            client_id: encodeURIComponent(SPOTIFY_CLIENT_ID),\r\n            code: encodeURIComponent(pkceCode),\r\n            redirect_uri: redirectUri,\r\n            code_verifier: encodeURIComponent(SPOTIFY_CODE_VERIFIER),\r\n        });\r\n\r\n        axios({\r\n            method: 'POST',\r\n            url: 'https://accounts.spotify.com/api/token',\r\n            headers: { \r\n                'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8'\r\n            },\r\n            data: encodedBody,\r\n            timeout: REQUEST_TIMEOUT_MS,\r\n        }).then(result => {\r\n            if(authCallback)\r\n                authCallback(result.data);\r\n        }).catch(error => {\r\n            console.error(error);\r\n            console.error(error.response.data);\r\n        });\r\n    },\r\n\r\n    /// Parses auth from Spotify into a better object\r\n    parseAuth: function (data) {\r\n        if(!data) {\r\n            return null;\r\n        }\r\n        \r\n        let expiresSeconds = data.expires_in;\r\n        /// Uncomment following to debug refreshing auth and having stable site state\r\n        // let minutes = 2;\r\n        // expiresSeconds = (SPOTIFY_REFRESH_MINUTES * 60) + minutes * 60;\r\n        let authExpireTime = this.getAuthExpireTime(expiresSeconds);\r\n        let scopes = data.scope.split(' ');\r\n\r\n        return {\r\n            authToken: data.access_token,\r\n            tokenType: data.token_type,\r\n            scopes: scopes,\r\n            refreshToken:  data.refresh_token,\r\n\r\n            expireDate: authExpireTime,\r\n        };\r\n    },\r\n\r\n    /// Refreshes old authentification using a refresh token\r\n    /// Callback for handling recieveing new Spotify auth\r\n    refreshAuth: function (refreshToken, authCallback) {\r\n        if(refreshToken) {\r\n            let encodedData = urlEncodeData({\r\n                grant_type: encodeURIComponent(\"refresh_token\"),\r\n                refresh_token: refreshToken,\r\n                client_id: encodeURIComponent(SPOTIFY_CLIENT_ID),\r\n            });\r\n\r\n            axios({\r\n                method: 'POST',\r\n                url: 'https://accounts.spotify.com/api/token',\r\n                headers: { \r\n                    'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8'\r\n                },\r\n                data: encodedData,\r\n                timeout: REQUEST_TIMEOUT_MS,\r\n            }).then(result => {\r\n                if(authCallback)\r\n                    authCallback(result.data);\r\n            }).catch(error => {\r\n               this.handleApiError(error);\r\n            });\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /// Debug with more info any API errors\r\n    handleApiError: function (error, apiPath) {\r\n        console.error(`Spotify API Error: '${apiPath}': '${error?.response?.data?.error?.message ?? error}'`);\r\n    },\r\n\r\n    // Gets the date plus the amount of seconds added on\r\n    getAuthExpireTime: function (seconds) {\r\n        return new Date(Date.now() + seconds * 1000);\r\n    },\r\n\r\n    makeApiRequest: function (method, url, authToken, callback) {\r\n        axios({\r\n            method: method,\r\n            url: url,\r\n            headers: { \r\n                'Authorization': 'Bearer ' + authToken,\r\n            },\r\n            timeout: REQUEST_TIMEOUT_MS,\r\n        }).then(result => {\r\n            if(callback)\r\n                callback(result.data);\r\n        }).catch(error => {\r\n            this.handleApiError(error, url);\r\n        });\r\n    },\r\n\r\n    makeApiDataRequest: function (method, url, authToken, data, callback) {\r\n        axios({\r\n            method: method,\r\n            url: url,\r\n            headers: { \r\n                'Authorization': 'Bearer ' + authToken,\r\n            },\r\n            data: data,\r\n            timeout: REQUEST_TIMEOUT_MS,\r\n        }).then(result => {\r\n            if(callback)\r\n                callback(result.data);\r\n        }).catch(error => {\r\n            this.handleApiError(error, url);\r\n        });\r\n    },\r\n\r\n    /// Gets the current playback state of Spotify\r\n    getCurrentPlaybackState: function (apiToken, callback) {\r\n        var endpointUrl = \"https://api.spotify.com/v1/me/player/\";\r\n\r\n        axios({\r\n            method: 'GET',\r\n            url: endpointUrl,\r\n            headers: { \r\n                'Authorization': 'Bearer ' + apiToken,\r\n            },\r\n            timeout: REQUEST_TIMEOUT_MS,\r\n        }).then(result => {\r\n            if(callback) {\r\n                callback(result.data);\r\n            }\r\n        }).catch(error => {\r\n            this.handleApiError(error);\r\n        });\r\n    },\r\n\r\n    /// Pauses the current track\r\n    pause: function (authToken) {\r\n        let endpointUrl = PROXY_URL + \"https://api.spotify.com/v1/me/player/pause\";\r\n        this.makeApiRequest(\"PUT\", endpointUrl, authToken);\r\n    },\r\n\r\n    /// Plays the current track\r\n    play: function(authToken) {\r\n        let endpointUrl = PROXY_URL + \"https://api.spotify.com/v1/me/player/play\";\r\n        this.makeApiRequest(\"PUT\", endpointUrl, authToken);\r\n    },\r\n\r\n    /// Changes current track to the previous \r\n    previousTrack: function (authToken) {\r\n        let url = PROXY_URL + \"https://api.spotify.com/v1/me/player/previous\";\r\n        this.makeApiRequest(\"POST\", url, authToken);\r\n    },\r\n\r\n    /// Skips to the next track\r\n    nextTrack: function (authToken) {\r\n        let url = PROXY_URL + \"https://api.spotify.com/v1/me/player/next\";\r\n        this.makeApiRequest(\"POST\", url, authToken);\r\n    },\r\n\r\n    /// Sets the current device's volume\r\n    setVolume: function (authToken, volume) {\r\n        let url = PROXY_URL + \"https://api.spotify.com/v1/me/player/volume\";\r\n        url += \"?volume_percent=\" + volume;\r\n        this.makeApiRequest(\"PUT\", url, authToken);\r\n    },\r\n\r\n    /// Seeks to a certain ms position in the current song\r\n    seek: function (authToken, positionMs) {\r\n        let url  = PROXY_URL + \"https://api.spotify.com/v1/me/player/seek\";\r\n        url += \"?position_ms=\" + positionMs;\r\n        this.makeApiRequest(\"PUT\", url, authToken);\r\n    },\r\n\r\n    getPlaybackDevices: function (authToken, callback) {\r\n        let url = \"https://api.spotify.com/v1/me/player/devices\";\r\n        this.makeApiRequest(\"GET\", url, authToken, callback)\r\n    },\r\n\r\n    setPlaybackDevice: function (authToken, targetDevice, play) {\r\n        let url = \"https://api.spotify.com/v1/me/player\";\r\n        let reqData = {\r\n            device_ids: [ targetDevice ],\r\n            play: play,\r\n        };\r\n        this.makeApiDataRequest(\"PUT\", url, authToken, reqData);\r\n    },\r\n\r\n    getCurrentUserProfile: function (authToken, callback) {\r\n        let url = \"https://api.spotify.com/v1/me\";\r\n        this.makeApiRequest(\"GET\", url, authToken, callback);\r\n    },\r\n}\r\n\r\nexport default SpotifyService;","// Cookie names used to store cookies\r\nexport const EGenifyCookieNames = {\r\n    // Stores JSON stringified of last auth\r\n    SPOTIFY_AUTH: \"spotify-auth\",\r\n};","import Home from \"./Home\";\r\n\r\nexport default Home;","import React, { Component } from 'react';\r\nimport { \r\n    Container,\r\n    Button,\r\n    Row,\r\n    Toast\r\n} from 'react-bootstrap';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faTwitter, faSpotify } from '@fortawesome/free-brands-svg-icons';\r\nimport { Redirect } from \"react-router-dom\";\r\nimport Cookies from \"js-cookie\";\r\n\r\nimport SpotifyService from \"../../services/spotify\";\r\nimport { EGenifyCookieNames } from \"../../enums/cookies\";\r\n\r\nimport \"./Home.css\";\r\n\r\n/// Handles converting an auth error code to an error message\r\nfunction getAuthMessage(authStatus) {\r\n    switch(authStatus)\r\n    {\r\n        case \"invalid\":\r\n            return \"A problem has occured trying to use a previous authorizatino. Please try again\";\r\n        case \"expired\":\r\n            return \"User's authorization has expired. Please sign in again\";\r\n        case \"refresh_error\":\r\n            return \"An error occured when attempting to refresh the previous Spotify authorization. Please sign in again\";\r\n        default:\r\n            return \"Unknown error. Sorry, you shouldn't see this\";\r\n    }\r\n}\r\n\r\nclass Home extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        // Check if auth expired or invalid\r\n        var params = new URLSearchParams(this.props.location.search);\r\n        var authStatus = params.get('auth');\r\n\r\n        this.state = {\r\n            authStatus: authStatus,\r\n            showAuthError: authStatus !== null,\r\n            redirect: null,\r\n        };\r\n\r\n        this.onGetSpotifyAuth = this.onGetSpotifyAuth.bind(this);\r\n    }\r\n\r\n    onGetSpotifyAuth() {\r\n        let prevAuthStr = Cookies.get(EGenifyCookieNames.SPOTIFY_AUTH, { path: '' });\r\n        if(prevAuthStr)\r\n        {\r\n            try\r\n            {\r\n                let prevAuth = JSON.parse(prevAuthStr);\r\n                if (prevAuth !== null && prevAuth.refreshToken) {\r\n                    this.setState({\r\n                        redirect: \"/app\",\r\n                    });\r\n                    // Return once auth has been validated\r\n                    return;\r\n                }\r\n            }\r\n            catch(e)\r\n            {\r\n                console.error(\"Unable to parse current stored cookie\");\r\n            }\r\n        }\r\n        // No auth stored, ask for auth from the user\r\n        let url = SpotifyService.getPKCEAuthUri();\r\n        window.location = url;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"text-center genify-home splash-gradiant text-white\">\r\n                <Row className=\"h-100 mx-0\">\r\n                    <Container className=\"my-auto\">\r\n                        <h1 \r\n                            style={{ fontSize: \"3rem\", fontWeight: \"300\" }}>\r\n                            Genify\r\n                        </h1>\r\n                        <h4 \r\n                            style={{ fontWeight: \"300\" }}\r\n                            className=\"py-2\">\r\n                            Combining music, lyrics and video\r\n                        </h4>\r\n                        <Button\r\n                            className=\"spotify-background py-2 px-5\"\r\n                            style={{ fontSize: \"1.25rem\", width: \"250px\" }}\r\n                            onClick={this.onGetSpotifyAuth}>\r\n                            <FontAwesomeIcon icon={faSpotify} className=\"mr-2\" />\r\n                            Sign In\r\n                        </Button>\r\n                        <div className=\"mx-auto mt-3\">\r\n                            <a href=\"https://joshlmao.com\" className=\"my-auto mr-2 text-white\">\r\n                                JoshLmao\r\n                            </a>\r\n                            <a href=\"https://twitter.com/joshlmao\">\r\n                                <Button \r\n                                    className=\"py-0 px-2\"\r\n                                    variant=\"outline-light\">\r\n                                    <FontAwesomeIcon icon={faTwitter} />\r\n                                </Button>\r\n                            </a>\r\n                        </div>\r\n                    </Container>\r\n                </Row>\r\n                {\r\n                    this.state.authStatus && \r\n                        <Toast \r\n                            show={this.state.showAuthError}\r\n                            onClose={() => this.setState({ showAuthError: false })}\r\n                            className=\"mr-2 mb-2 text-left\"\r\n                            style={{\r\n                                position: 'absolute',\r\n                                bottom: 0,\r\n                                right: 0,\r\n                                color: \"black\",\r\n                            }}>\r\n                            <Toast.Header>\r\n                                <strong className=\"mr-auto\">A Problem Occured</strong>\r\n                                {/* <small>11 mins ago</small> */}\r\n                            </Toast.Header>\r\n                            <Toast.Body>\r\n                                { getAuthMessage(this.state.authStatus) }\r\n                            </Toast.Body>\r\n                        </Toast>\r\n                }\r\n                {\r\n                    this.state.redirect && <Redirect to={this.state.redirect} />\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Home;","import React, { Component } from 'react';\r\nimport {\r\n    Navbar,\r\n    Nav,\r\n    Container,\r\n    Button,\r\n    Modal,\r\n} from \"react-bootstrap\";\r\nimport { \r\n    faGithub,\r\n    faTwitter\r\n} from '@fortawesome/free-brands-svg-icons' ;\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport ReactMarkdown from \"react-markdown\";\r\n\r\nimport {\r\n    TWITTER_LINK,\r\n    GITHUB_LINK\r\n} from \"../../consts\";\r\n\r\nimport changelogs from \"../../json/changelog.json\";\r\nlet pkg = require('../../../package.json');\r\n\r\nclass Navigation extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            displayChangelog: false,\r\n        };\r\n\r\n        this.toggleChangelog = this.toggleChangelog.bind(this);\r\n    }\r\n\r\n    toggleChangelog() {\r\n        this.setState({\r\n            displayChangelog: !this.state.displayChangelog,\r\n        });\r\n    }\r\n\r\n    render() {\r\n        let modalBgColor = \"#111\";\r\n        let modalSeparatorColor = \"#222\";\r\n        return (\r\n            <div className=\"genify-navbar\">\r\n                <Navbar \r\n                    className=\"genify-nav-bg\"\r\n                    expand=\"sm\">\r\n                    <Container>\r\n                        <Navbar.Brand href=\"/\" className=\"text-white\">Genify</Navbar.Brand>\r\n                        <Nav.Link \r\n                            className=\"p-0 align-bottom mt-1\"\r\n                            style={{ fontSize: \"0.85rem\" }}\r\n                            href=\"\" \r\n                            onClick={this.toggleChangelog}>\r\n                                {\r\n                                    pkg ? \"v\" + pkg.version : \"v0.0.0\"\r\n                                }\r\n                            </Nav.Link>\r\n                        <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\r\n                        <Navbar.Collapse id=\"basic-navbar-nav\">\r\n                            <Nav className=\"ml-auto\">\r\n                                <Nav.Link className=\"py-0\" href={GITHUB_LINK}>\r\n                                    <Button variant=\"outline-secondary\">\r\n                                        <FontAwesomeIcon icon={faGithub} />\r\n                                    </Button>\r\n                                </Nav.Link>\r\n                                <Nav.Link className=\"py-0\" href={TWITTER_LINK}>\r\n                                    <Button variant=\"outline-secondary\">\r\n                                        <FontAwesomeIcon icon={faTwitter} />\r\n                                    </Button>\r\n                                </Nav.Link>\r\n                            </Nav>\r\n                        </Navbar.Collapse>\r\n                    </Container>\r\n                </Navbar>\r\n                {\r\n                    this.state.displayChangelog &&\r\n                    <Modal\r\n                        size=\"lg\"\r\n                        show={this.state.displayChangelog}\r\n                        onHide={() => this.toggleChangelog()}\r\n                        className=\"changelog-modal\">\r\n                        <Modal.Header \r\n                            closeButton\r\n                            style={{ \r\n                                backgroundColor: modalBgColor,\r\n                                borderColor: modalSeparatorColor,\r\n                            }}>\r\n                            <Modal.Title id=\"example-modal-sizes-title-lg\">\r\n                                Changelog\r\n                            </Modal.Title>\r\n                        </Modal.Header>\r\n                        <Modal.Body\r\n                            className=\"changelog-body\">\r\n                            {   \r\n                                changelogs.logs.map((log) => {\r\n                                    return (\r\n                                        <div>\r\n                                            <h3>{log.version}</h3>\r\n                                            <ul>\r\n                                                {\r\n                                                    log.changes.map((change) => {\r\n                                                        return (\r\n                                                            <li>\r\n                                                                <ReactMarkdown source={change} className=\"no-child-margins\"/>\r\n                                                            </li>\r\n                                                        );\r\n                                                    })\r\n                                                }\r\n                                            </ul>\r\n                                        </div>\r\n                                    )\r\n                                })\r\n                            }\r\n                        </Modal.Body>\r\n                        <Modal.Footer\r\n                            style={{ \r\n                                backgroundColor: modalBgColor,\r\n                                borderColor: modalSeparatorColor,\r\n                            }}>\r\n                            <Button \r\n                                variant=\"outline-light\"\r\n                                className=\"ml-auto\" onClick={() => { this.toggleChangelog(); console.log(\"updating\"); }}>\r\n                                Close\r\n                            </Button>\r\n                        </Modal.Footer>\r\n                    </Modal>\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Navigation;","import Navigation from \"./Navigation\";\r\n\r\nexport default Navigation;","import FourOhFour from \"./FourOhFour\";\r\n\r\nexport default FourOhFour;","import React, { Component } from 'react';\r\nimport { Row, Container, Button } from \"react-bootstrap\";\r\nimport { Redirect } from 'react-router-dom';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faHome } from '@fortawesome/free-solid-svg-icons';\r\n\r\nclass FourOhFour extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            redirect: \"\",\r\n        };\r\n\r\n        this.onReturn = this.onReturn.bind(this);\r\n    }\r\n\r\n    onReturn() {\r\n        this.setState({\r\n            redirect: \"/\",\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Row\r\n                className=\"w-100 spotify-black genify-home px-0\">\r\n                <Container className=\"pt-5\">\r\n                    <h2 className=\"text-center pt-5\">\r\n                        Error 404: Page Not Found\r\n                    </h2>\r\n                    <h6 className=\"text-center\">\r\n                        你迷路了吗？\r\n                    </h6>\r\n                    <div className=\"py-3\"></div>\r\n                    <h5 className=\"mx-auto\">\r\n                        This page can't be found. Are you sure you typed it in correctly?\r\n                    </h5>\r\n                    <div className=\"mx-auto\">\r\n                        <Button  className=\"mx-auto\"\r\n                            onClick={this.onReturn}\r\n                            variant=\"outline-light\">\r\n                                <FontAwesomeIcon \r\n                                    icon={faHome}\r\n                                    className=\"mr-2\" />\r\n                                Click here to get right back to the music\r\n                        </Button>\r\n                    </div>\r\n                </Container>\r\n                {\r\n                    this.state.redirect && <Redirect to={this.state.redirect}>here</Redirect>\r\n                }\r\n            </Row>\r\n        );\r\n    }\r\n}\r\n\r\nexport default FourOhFour;","/// Enum of all supported languages to romanize/unromanize\r\nexport const ELanguages = {\r\n    NONE: \"none\",\r\n    ENG: \"english\",\r\n    SZH: \"simplified-chinese\",\r\n    TZH: \"traditional-chinese\",\r\n    KR: \"korean\",\r\n    JP: \"japanese\",\r\n    RU: \"russian\",\r\n}\r\n\r\n/// Determines the primary majority language from a string\r\nexport function determineLanguage(str) {\r\n    let lang = ELanguages.NONE;\r\n\r\n    // Expression for detecting any Korean characters\r\n    var koreanChars = getKoreanChars(str);\r\n    if( koreanChars !== null ) { \r\n        lang = ELanguages.KR;\r\n    }\r\n    \r\n    // Detect both Chinese & Japanese\r\n    var japaneseChars = getJapaneseChars(str);\r\n    var chineseChars = getChineseChars(str);\r\n    // Determine language by seeing which contains the most characters \r\n    if( japaneseChars !== null && chineseChars !== null ) { \r\n        if( japaneseChars.length > chineseChars.length ) {\r\n            lang = ELanguages.JP;\r\n        } else {\r\n            lang = ELanguages.SZH;\r\n        }\r\n    } else if ( japaneseChars !== null ) {\r\n        lang = ELanguages.JP;\r\n    } else if( chineseChars !== null ) {\r\n        lang = \"chinese\";\r\n    }\r\n\r\n    var russianChars = getRussianChars(str);\r\n    if( russianChars !== null ) {\r\n        lang = ELanguages.RU;\r\n    }\r\n\r\n    // Detect if majority of chars are Simplified or Traditional\r\n    if( lang === \"chinese\" ) {\r\n        // Using to detect\r\n        // https://github.com/nickdrewe/traditional-or-simplified\r\n        //var result = TradOrSimp.detect(str);\r\n        // if (result.detectedCharacters === 'simplified') {\r\n        //     lang = ELanguages.SZH;\r\n        // } else {\r\n        //     lang = ELanguages.TZH;\r\n        // }\r\n        lang = ELanguages.SZH;\r\n    }\r\n    \r\n    // No other languages, set to English\r\n    if( koreanChars == null && japaneseChars == null && chineseChars == null && russianChars == null ) {\r\n        lang = ELanguages.ENG;\r\n    }\r\n\r\n    return lang;\r\n}\r\n\r\n// Returns an array of all Korean characters in string\r\nexport function getKoreanChars(str) {\r\n    return str.match(/[\\uac00-\\ud7af]|[\\u1100-\\u11ff]|[\\u3130-\\u318f]|[\\ua960-\\ua97f]|[\\ud7b0-\\ud7ff]/g);\r\n}\r\n\r\n// Matches Hirgana or Katakana (https://gist.github.com/oanhnn/9043867)\r\nexport function getJapaneseChars(str) {\r\n    return str.match(/[ぁ-んァ-ン]/g);\r\n}\r\n\r\n// Returns an array of all Chinese characters in string\r\nexport function getChineseChars(str) {\r\n    return str.match(/[\\u2E80-\\u2FD5\\u3190-\\u319f\\u3400-\\u4DBF\\u4E00-\\u9FCC\\uF900-\\uFAAD]/g);\r\n}\r\n\r\nexport function getRussianChars(str) {\r\n    return str.match(/^[аАбБвВгГдДеЕёЁжЖзЗиИйЙкКлЛмМнНоОпПрРсСтТуУфФхХцЦчЧшШщЩъЪыЫьЬэЭюЮяЯ]+$/);\r\n}","/// Removes any brackets from inside a string\r\nexport function filterBrackets(str) {\r\n    return str.replace(/ *\\([^)]*\\) */g, \"\");\r\n}\r\n\r\n/// Removes any new line or spaces at start and end string\r\nexport function filterStartEndSpaceChars(str) {\r\n    return str.replace(/^\\s+|\\s+$/g, '');\r\n}\r\n\r\n/// Removes any special characters\r\nexport function filterSpecialChars(str) {\r\n    return str.replace(/[^\\w\\s]/gi, '');\r\n}\r\n\r\n// Replaces any special space characters with a \"normal\" space\r\nexport function filterSpecialSpace(str) {\r\n    return str.replace(/\\s/g, ' ');\r\n}\r\n\r\n/// Strips a string of common irrelevant chars and returns a lower case version\r\nexport function processString (str) {\r\n    // Replace any weird space chars \r\n    str = filterSpecialSpace(str);\r\n    // Remove any special chars\r\n    str = filterSpecialChars(str);\r\n\r\n    // Return lower case'd version\r\n    return str.toLowerCase();\r\n}","import axios from \"axios\";\r\nimport {\r\n    GENIUS_ACCESS_TOKEN,\r\n    REQUEST_TIMEOUT_MS,\r\n    PROXY_URL\r\n} from \"../consts\";\r\nimport { \r\n    filterBrackets,\r\n    filterStartEndSpaceChars,\r\n    processString\r\n} from \"../helpers/filterHelper\";\r\n\r\nconst GeniusService = {\r\n\r\n    /// Searches the Genius API using the spotify play context\r\n    search: function (playData, callback) {\r\n        if (!playData) \r\n            return null;\r\n\r\n        let filteredTitle = filterBrackets(playData.item.name);\r\n        let searchTerm = encodeURIComponent(`${filteredTitle} ${playData.item.artists[0].name}`);\r\n        let geniusUrl = PROXY_URL + \"https://api.genius.com/search?q=\" + searchTerm;\r\n        axios({\r\n            method: 'GET',\r\n            url: geniusUrl,\r\n            headers: { 'Authorization': 'Bearer ' + GENIUS_ACCESS_TOKEN },\r\n            timeout: REQUEST_TIMEOUT_MS,\r\n        }).then(result => {\r\n            if(callback) {\r\n                callback(result.data);\r\n            }\r\n        }).catch(error => {\r\n            console.error(error);\r\n        });\r\n    },\r\n\r\n    /// Parses HTML from a url and returns the page's lyrics\r\n    parseLyricsFromUrl(geniusUrl, callback) {\r\n        var url = PROXY_URL + geniusUrl + \"?react=1\";\r\n        axios({\r\n            method: 'GET',\r\n            url: url,\r\n            headers: { 'Authorization': 'Bearer ' + GENIUS_ACCESS_TOKEN },\r\n            timeout: REQUEST_TIMEOUT_MS,\r\n        }).then(result => {\r\n            if(callback) {\r\n                var parseHTML = function(str) {\r\n                    var tmp = document.implementation.createHTMLDocument();\r\n                    tmp.body.innerHTML = str;\r\n                    return tmp.body;\r\n                };\r\n                  \r\n                let allLyrics = \"\";\r\n\r\n                let html = parseHTML(result.request.responseText);\r\n                let isNewGeniusLayout = html.querySelectorAll(\".lyrics\").length <= 0;\r\n                if (isNewGeniusLayout) {\r\n                    // Using new Genius layout\r\n                    let allDivs = html.getElementsByTagName(\"div\");\r\n                    for(let div of allDivs) {\r\n                        let lowercase = div.className.toLowerCase();\r\n                        if(lowercase.includes(\"lyric\") && lowercase.includes(\"container\")) {\r\n                            //Get initial html content\r\n                            let innerHtml = div.innerHTML;\r\n                            // Remove line breaks used as line endings\r\n                            let brGone = innerHtml.replace(/<br>/g, '\\n');\r\n                            // Replace <div>...</div> content used for ads\r\n                            let aGone = brGone.replace(/<[^>]*>?/gm, '');\r\n                            allLyrics  += aGone;\r\n                        }\r\n                    }\r\n                    if (allLyrics) \r\n                    {\r\n                        let filteredLyrics = filterStartEndSpaceChars(allLyrics);\r\n                        callback(filteredLyrics);\r\n                    } else {\r\n                        console.error(`Unable to parse lyrics correctly from page ${url}`);\r\n                    }\r\n                } else {\r\n                    //Old Genius layout, use old algorithm\r\n                    let filtered = html.querySelectorAll(\".lyrics\");\r\n                    if (filtered.length > 0) \r\n                    {\r\n                        let filteredLyrics = filterStartEndSpaceChars(filtered[0].textContent);\r\n                        callback(filteredLyrics);\r\n                    }\r\n                    else\r\n                        console.error(\"Unable to parse lyrics from old Genius layout\");\r\n                }\r\n            }\r\n        }).catch(error => {\r\n            console.error(error);\r\n        });\r\n    },\r\n\r\n    /// Gets the most relevant result from a range of hits from the Genius API, \r\n    /// using the Spotify track 'item'\r\n    getRelevantResult: function (hits, trackInfo) {\r\n        if (!trackInfo) {\r\n            return;\r\n        }\r\n        if (hits && hits.length > 0) {\r\n            for(let hit of hits) {\r\n                // genius artist - track\r\n                var geniusArtist = processString(hit.result.primary_artist.name);\r\n                var geniusTrackName = processString(hit.result.title);\r\n                // spotify artist - track\r\n                var spotifyTrackName = processString(trackInfo.name);\r\n                var spotifyFirstArtistName = processString(trackInfo.artists[0].name);\r\n\r\n                // Check if Genius track name/artist includes Spotify track name/artist or vice versa\r\n                let geniusIncludes = geniusArtist.includes(spotifyFirstArtistName) && geniusTrackName.includes(spotifyTrackName);\r\n                let spotifyIncludes = spotifyFirstArtistName.includes(geniusArtist) && spotifyTrackName.includes(geniusTrackName);\r\n\r\n                if (geniusIncludes || spotifyIncludes) {\r\n                    return hit;\r\n                }\r\n            }\r\n        } else {\r\n            return null;\r\n        }\r\n    },\r\n}\r\n\r\nexport default GeniusService;","import React, { Component } from 'react';\r\nimport {\r\n    Button, \r\n    Form,\r\n    Col\r\n} from \"react-bootstrap\";\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faSpinner } from '@fortawesome/free-solid-svg-icons';\r\nimport {\r\n    determineLanguage,\r\n    ELanguages\r\n} from \"../../helpers/languageHelper\";\r\n\r\nimport Kuroshiro from \"kuroshiro\";\r\nimport KuromojiAnalyzer from \"kuroshiro-analyzer-kuromoji\";\r\nimport pinyin4js from 'pinyin4js';\r\nimport Aromanize from \"aromanize\";\r\nimport cyrillicToTranslit from \"cyrillic-to-translit-js\";\r\n\r\nimport GeniusService from '../../services/genius';\r\nimport \"./Lyrics.css\";\r\n\r\nclass Lyrics extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        const kuroshiro = new Kuroshiro();\r\n        kuroshiro.init(new KuromojiAnalyzer({ \r\n            // Path starts at base of public folder\r\n            dictPath: \"./dict\" \r\n        }));\r\n\r\n        this.state = {\r\n            // Current playState of Spotify\r\n            playState: props.playState,\r\n\r\n            originalLyrics: null,\r\n            romanizedLyrics: null,\r\n\r\n            // Current lyrics that are loaded, the spotify track info\r\n            lyricsSpotifyTrackName: null,\r\n            // Current lyrics info from Genius\r\n            lyricsInfo: null,\r\n            // Are the lyrics loaded\r\n            loaded: true,\r\n            /// Are the current romanizedLyrics romanized or not?\r\n            isRomanized: false,\r\n            /// Current determined language of the original lyric language\r\n            originalLyricLanguage: ELanguages.NONE,\r\n            // Kuroshiro object for using Kuroshiro functions\r\n            kuroshiro: kuroshiro,\r\n            // Should lyrics perform an update/search for (new) lyrics\r\n            shouldUpdateLyrics: true,\r\n        };\r\n\r\n        this.updateLyrics = this.updateLyrics.bind(this);\r\n        this.onToggleRomanize = this.onToggleRomanize.bind(this);\r\n        this.resetLyricState = this.resetLyricState.bind(this);\r\n        this.onRetryLyricsBtn = this.onRetryLyricsBtn.bind(this);\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        if(prevProps.playState !== this.props.playState) {\r\n            this.setState({\r\n                playState: this.props.playState,\r\n            },() => {\r\n                // prevProps hasnt been set or song changed\r\n                if (prevProps.playState === null || prevProps.playState?.item?.name !== this.props.playState.item?.name) {\r\n                    this.updateLyrics();\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    updateLyrics() {\r\n        // Only continue if we have a valid state and isn't loading other lyrics\r\n        if(this.state.playState && this.state.loaded) {\r\n            this.setState({ \r\n                loaded: false, \r\n                shouldUpdateLyrics: false,\r\n                lyricsSpotifyTrackName: null,\r\n            });\r\n\r\n            GeniusService.search(this.state.playState, (result) => {\r\n                if(result.response.hits.length > 0) {\r\n                    // Search hits for most relevant result\r\n                    let info = GeniusService.getRelevantResult(result.response.hits, this.state.playState.item);\r\n                    if (info) {\r\n                        // Relevant Genius lyrics found\r\n                        console.log(`Relevant Result: ${info.result.full_title}`);\r\n                        GeniusService.parseLyricsFromUrl(info.result.url, (lyrics) => {\r\n                            console.log(`Loaded and set lyrics from ${info.result.url}`);\r\n                            let origLyricLang = determineLanguage(lyrics);\r\n                            console.log(`Original lyrics language: '${origLyricLang}'`);\r\n                            this.setState({\r\n                                originalLyrics: lyrics,\r\n                                romanizedLyrics: lyrics,\r\n                                isRomanized: false,\r\n\r\n                                originalLyricLanguage: origLyricLang,\r\n\r\n                                lyricsInfo: info,\r\n                                loaded: true,\r\n                                lyricsSpotifyTrackName: this.state.playState.item,\r\n                            });\r\n                        });\r\n                    } else {\r\n                        // No relevant Genius lyrics found\r\n                        console.log(`No related lyrics found out of '${result.response.hits.length}' results for song '${this.state.playState.item.artists[0].name} - ${this.state.playState.item.name}'`);\r\n                        this.setState({\r\n                            loaded: true,\r\n                        });\r\n                        this.resetLyricState();\r\n                    }\r\n                } else {\r\n                    // No search hits found at all\r\n                    console.log(\"Didn't find any search results on Genius\");\r\n                    this.setState({\r\n                        loaded: true,\r\n                    });\r\n                    this.resetLyricState();\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    resetLyricState() {\r\n        this.setState({\r\n            originalLyrics: null,\r\n            romanizedLyrics: null,\r\n            lyricsInfo: null,\r\n            isRomanized: false,\r\n            originalLyricLanguage: ELanguages.NONE,\r\n        });\r\n    }\r\n\r\n    onToggleRomanize() {\r\n        if (!this.state.originalLyrics) {\r\n            return;\r\n        }\r\n\r\n        if (this.state.isRomanized) {\r\n            this.setState({\r\n                romanizedLyrics: this.state.originalLyrics,\r\n            });\r\n        } else {\r\n            let romanizedLyrics = \"\";\r\n            switch(this.state.originalLyricLanguage)\r\n            {\r\n                case ELanguages.JP:\r\n                    {\r\n                        if (!this.state.kuroshiro) { break; }\r\n                        romanizedLyrics = \"...\";\r\n                        this.state.kuroshiro.convert(this.state.originalLyrics, { \r\n                            to: \"romaji\",\r\n                            mode: \"spaced\",\r\n                        }).then((romajiLyrics) => {\r\n                            // remove double space added inbetween other phrases\r\n                            romajiLyrics = romajiLyrics.replace(/ +(?= )/g,'');\r\n                            this.setState({\r\n                                romanizedLyrics: romajiLyrics,\r\n                            });\r\n                        });\r\n                        break;\r\n                    }\r\n                    case ELanguages.SZH:\r\n                    case ELanguages.TZH:\r\n                        {\r\n                            romanizedLyrics = pinyin4js.convertToPinyinString(this.state.originalLyrics, ' ', pinyin4js.WITH_TONE_MARK)\r\n                            break;\r\n                        }\r\n                    case ELanguages.KR:\r\n                        {\r\n                            romanizedLyrics = Aromanize.romanize(this.state.originalLyrics);\r\n                            break;\r\n                        }\r\n                    case ELanguages.RU:\r\n                        {\r\n                            romanizedLyrics = cyrillicToTranslit().transform(this.state.originalLyrics, \" \");\r\n                            break;\r\n                        }\r\n                default:\r\n                    break;\r\n            }\r\n            this.setState({\r\n                romanizedLyrics: romanizedLyrics,\r\n            });\r\n        }\r\n\r\n        this.setState({\r\n            isRomanized: !this.state.isRomanized,\r\n        });\r\n    }\r\n\r\n    onRetryLyricsBtn() {\r\n        if (!this.state.shouldUpdateLyrics) {\r\n            this.setState({ shouldUpdateLyrics: true }, () => this.updateLyrics() );\r\n            console.log(\"Retrying lyrics at request of user\");\r\n        }\r\n    }\r\n    \r\n    render() {\r\n        return (\r\n            <div className=\"py-2 w-100 h-100\">\r\n                <div className=\"text-center h-100\">\r\n                    {\r\n                        !this.state.loaded && <FontAwesomeIcon className=\"fa-spin\" size=\"3x\" icon={faSpinner} />\r\n                    }\r\n                    {/* Lyrics container */}\r\n                    {\r\n                        this.state.romanizedLyrics && this.state.loaded &&\r\n                        <div className=\"h-100\">\r\n                             <Col \r\n                                md={3} \r\n                                sm={3}\r\n                                className=\"pr-4 pl-0 mb-2 text-right d-none d-sm-block\"\r\n                                style={{ \r\n                                    height: \"35px\", \r\n                                    position: \"absolute\", \r\n                                    right: 0,\r\n                                    fontSize: \"0.8rem\",\r\n                                    }}>\r\n                                    <h6 className=\"mb-1\">Lyric Info</h6>\r\n                                    <a \r\n                                        href={this.state.lyricsInfo.result.url}\r\n                                        className=\"py-1\">\r\n                                        {this.state.lyricsInfo.result.full_title}\r\n                                    </a>\r\n                                    {\r\n                                        this.state.originalLyricLanguage !== ELanguages.ENG && \r\n                                        <Form>\r\n                                            <Form.Check\r\n                                                type=\"switch\"\r\n                                                id=\"custom-switch\"\r\n                                                label=\"Romanize\"\r\n                                                onChange={this.onToggleRomanize}>\r\n                                            </Form.Check>\r\n                                        </Form>\r\n                                        \r\n                                    }\r\n                            </Col>\r\n                            <div className=\"lyrics-content\" >\r\n                                { this.state.romanizedLyrics }\r\n                            </div>\r\n                        </div>\r\n                    }\r\n                    {/* No song/lyrics UI */}\r\n                    {\r\n                        !this.state.originalLyrics && this.state.loaded && \r\n                        <div className=\"d-flex flex-column\">\r\n                            <a href=\"https://genius.com/new\">\r\n                                <Button variant=\"outline-light\" className=\"mt-2\"> \r\n                                    Add to Genius\r\n                                </Button>\r\n                            </a>\r\n                            <Button \r\n                                className=\"mx-auto my-2\"\r\n                                variant=\"outline-light\" \r\n                                onClick={this.onRetryLyricsBtn}>\r\n                                Retry Lyrics\r\n                            </Button>\r\n                        </div>\r\n                    }\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Lyrics;","import ContentSelector from \"./ContentSelector\";\r\n\r\nexport default ContentSelector;","import React, { Component } from 'react';\r\nimport { Container } from 'react-bootstrap';\r\n\r\nclass ContentSelector extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        \r\n        this.state = {\r\n            contentSelectedCallback: props.onContentSelected,\r\n            selections: [\r\n                \"lyrics\", \"settings\"\r\n            ],\r\n            selectedSelection: \"lyrics\",\r\n        }\r\n\r\n        this.onSelectContent = this.onSelectContent.bind(this);\r\n    }\r\n\r\n    onSelectContent(event) {\r\n        let target = event.target;\r\n     \r\n        this.setState({\r\n            selectedSelection: target.dataset.tag,\r\n        });\r\n\r\n        this.state.contentSelectedCallback(target.dataset.tag);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"genify-nav-bg w-100\">\r\n                <Container \r\n                    className=\"h-100 d-flex align-items-center genify-light-background\">\r\n                    {\r\n                        this.state.selections && this.state.selections.map((value, index) => {\r\n                            return (\r\n                                <div    \r\n                                    onClick={this.onSelectContent}\r\n                                    className={`content-selector-item mx-auto ${this.state.selectedSelection === value && \"active-selection\"}`}\r\n                                    data-tag={value}\r\n                                    key={value}>\r\n                                    <h6 \r\n                                        data-tag={value}\r\n                                        className=\"m-0\">{value}</h6>\r\n                                </div>\r\n                            )\r\n                        })\r\n                    }                    \r\n                </Container>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default ContentSelector;","import React, { Component } from 'react';\r\nimport { Container, Button } from 'react-bootstrap';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faSpotify, faTwitter, faGithub } from '@fortawesome/free-brands-svg-icons';\r\nimport { EGenifyCookieNames } from '../../enums/cookies';\r\nimport { Redirect } from 'react-router-dom';\r\nimport Cookies from \"js-cookie\";\r\nimport SpotifyService from '../../services/spotify';\r\n\r\nfunction SettingNameValue(props) {\r\n    return (\r\n        <div className=\"d-flex\" {...props}>\r\n            <div>\r\n                {props.name}\r\n            </div>\r\n            <div className=\"ml-auto\">\r\n                {props.value}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nclass Settings extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            auth: props.auth,\r\n\r\n            redirect: \"\",\r\n\r\n            userProfile: null,\r\n        };\r\n\r\n        this.onSpotifySignOut = this.onSpotifySignOut.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        // Fetch data from spotify\r\n        if (this.state.auth) {\r\n            SpotifyService.getCurrentUserProfile(this.state.auth.authToken, (profileData) => {\r\n                //console.log(profileData);\r\n                this.setState({\r\n                    userProfile: profileData,\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        if (prevProps.auth !== this.props.auth) {\r\n            this.setState({\r\n                auth: this.props.auth,\r\n            });\r\n        }\r\n    }\r\n\r\n    onSpotifySignOut() {\r\n        console.log(\"Signing out of Genify\");\r\n\r\n        // Remove cookie by setting it to blank\r\n        if(Cookies.get(EGenifyCookieNames.SPOTIFY_AUTH)) {\r\n            Cookies.set(EGenifyCookieNames.SPOTIFY_AUTH, \"\", { path: '', expires: 365 });\r\n        }\r\n\r\n        this.setState({\r\n            redirect: \"/\",\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"w-100 h-100\">\r\n                <Container className=\"py-2 px-5 scrollable-main-content\">\r\n                    <h2 className=\"mb-4\">App Settings</h2>\r\n\r\n                    <h5>Spotify</h5>\r\n                    {/* User Overview */}\r\n                    <div className=\"d-flex px-3 my-3\">\r\n                        <img\r\n                            alt=\"Signed in user icon\"\r\n                            src={this.state.userProfile?.images[0]?.url} \r\n                            style={{ maxHeight: \"50px\", maxWidth: \"50px\" }} />\r\n                            <div className=\"px-3\">\r\n                                <h6>{this.state.userProfile?.display_name}</h6>\r\n                                <h6\r\n                                    style={{ color: \"rgb(200, 200, 200)\", fontSize: \"0.8rem\" }}>\r\n                                    {\"SPOTIFY \" + this.state.userProfile?.product.toUpperCase()}\r\n                                </h6>\r\n                            </div>\r\n                            <a \r\n                                href={this.state.userProfile?.external_urls?.spotify}\r\n                                target=\"noopener\"\r\n                                className=\"ml-auto\">\r\n                                <Button variant=\"outline-success\">\r\n                                    Profile\r\n                                </Button>\r\n                            </a>\r\n                    </div>\r\n                    <SettingNameValue name=\"Account Id\" value={this.state.userProfile?.id} />\r\n                    <SettingNameValue name=\"Followers\" value={this.state.userProfile?.followers?.total} />\r\n                    <SettingNameValue name=\"Region\" value={this.state.userProfile?.country} />\r\n                    <SettingNameValue name=\"Enable Web Playback\" value=\"Coming Soon...\" />\r\n                    <div className=\"w-100 text-right my-2\">\r\n                        <Button\r\n                            variant=\"success\"\r\n                            onClick={this.onSpotifySignOut}>\r\n                            <FontAwesomeIcon \r\n                                className=\"mr-2\"\r\n                                icon={faSpotify} />\r\n                            Sign Out\r\n                        </Button>\r\n                    </div>\r\n                    \r\n                    <div className=\"horizontal-separator\" />\r\n\r\n                    <h5>Language</h5>\r\n                    <SettingNameValue name=\"Automatic Romanize\" value=\"Coming Soon...\" />\r\n\r\n                    <div className=\"horizontal-separator\" />\r\n            \r\n                    <h4>Credits</h4>\r\n                    <div className=\"d-flex mb-2\">\r\n                        <p className=\"my-0\">Created By</p>\r\n                        <div className=\"ml-auto d-flex\">\r\n                            <a href=\"https://joshlmao.com\" className=\"mx-2\">\r\n                                <p className=\"my-0\">JoshLmao</p>\r\n                            </a>\r\n                            <a href=\"https://github.com/JoshLmao\" target=\"noopener\" className=\"mx-2\">\r\n                                <FontAwesomeIcon icon={faGithub} />\r\n                            </a>\r\n                            <a href=\"https://twitter.com/JoshLmao\" target=\"noopener\" className=\"mx-2\">\r\n                                <FontAwesomeIcon icon={faTwitter} />\r\n                            </a>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <p>If you enjoy this app, please consider supporting me through one of the options below. If not, thank you for using and enjoying the app! <span role=\"img\" aria-label=\"hug emoji\">🤗</span></p>\r\n                    <p className=\"text-center\">\r\n                        <a \r\n                            href=\"https://github.com/sponsors/JoshLmao\"\r\n                            className=\"m-2\">\r\n                            <img \r\n                                alt=\"Github Sponsor Advert\"\r\n                                src={process.env.PUBLIC_URL + '/img/github-sponsor.png'} \r\n                                className=\"my-2\"\r\n                                height=\"50px\"/>\r\n                        </a>\r\n                        <a \r\n                            href=\"https://brave.com/jos677\" \r\n                                className=\"m-2\">\r\n                            <img \r\n                                alt=\"Brave Browser advert\"\r\n                                src={process.env.PUBLIC_URL + '/img/BraveBat.png'} \r\n                                className=\"my-2\"\r\n                                style={{ height: \"40px\" }} />\r\n                        </a>\r\n                        <a \r\n                            href=\"https://paypal.me/xjoshlmao\"\r\n                            className=\"m-2\">\r\n                            <img \r\n                                alt=\"Paypal Donation Advert\"\r\n                                src=\"https://i.imgur.com/UfSd0gP.png\" \r\n                                className=\"my-2\"\r\n                                style={{ height: \"50px\" }} />\r\n                        </a>\r\n                    </p>\r\n\r\n                </Container>\r\n                {\r\n                    this.state.redirect && <Redirect to={this.state.redirect} />\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Settings;","import Settings from \"./Settings\";\r\n\r\nexport default Settings;","import React, { Component } from 'react';\r\nimport {\r\n    Popover,\r\n    ListGroup,\r\n    OverlayTrigger,\r\n    Button,\r\n} from \"react-bootstrap\";\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport {\r\n    faSpinner,\r\n    faDesktop,\r\n} from \"@fortawesome/free-solid-svg-icons\";\r\nimport {\r\n    deviceTypeToIcon\r\n} from \"../../helpers/spotifyHelper\";\r\nimport SpotifyService from '../../services/spotify';\r\n\r\nclass DevicesPopover extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            devices: props.devices,\r\n            auth: props.auth,\r\n\r\n            showDevicesPopover: false,\r\n            popoverLocationTarget: null,\r\n        };\r\n\r\n        this.onSelectPlaybackDevice = this.onSelectPlaybackDevice.bind(this);\r\n        this.handleDisplayDeviceSelector = this.handleDisplayDeviceSelector.bind(this);\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        if(prevProps.devices !== this.props.devices) {\r\n            this.setState({ devices: this.props.devices });\r\n        }\r\n        if(prevProps.auth !== this.props.auth) {\r\n            this.setState({ auth: this.props.auth });\r\n        }\r\n    }\r\n\r\n    handleDisplayDeviceSelector(event) {\r\n        this.setState({\r\n            showDevicesPopover: !this.state.showDevicesPopover,\r\n            popoverLocationTarget: event.target,\r\n        });\r\n    }\r\n\r\n    onSelectPlaybackDevice(event) {\r\n        let deviceId = event.target.dataset.deviceid;\r\n        SpotifyService.setPlaybackDevice(this.state.auth.authToken, deviceId, true);\r\n\r\n        // Update local state of devices\r\n        this.state.devices.find(x => x.is_active === true).is_active = false;\r\n        this.state.devices.find(x => x.id === deviceId).is_active = true;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <OverlayTrigger\r\n                placement=\"bottom\"\r\n                trigger=\"click\"\r\n                overlay={\r\n                    <Popover \r\n                        id=\"devices-popover\"\r\n                        className=\"genify-dark-background\"\r\n                        {...this.props}>\r\n                        <Popover.Title as=\"h3\" className=\"playback-devices-title text-center\">\r\n                            Connect to a device\r\n                        </Popover.Title>\r\n                        <Popover.Content>\r\n                            <ListGroup variant=\"flush\">\r\n                            {\r\n                                this.state.devices && this.state.devices.map((value, index) => {\r\n                                    return (\r\n                                        <ListGroup.Item \r\n                                            action \r\n                                            onClick={this.onSelectPlaybackDevice}\r\n                                            key={value.id}\r\n                                            className={`playback-device-item ${value.is_active ? \"active-device\" : \"\"}`}\r\n                                            data-deviceid={value.id}>\r\n                                                <FontAwesomeIcon icon={deviceTypeToIcon(value.type)} className=\"mr-2\"/>\r\n                                            {value.name}\r\n                                        </ListGroup.Item>\r\n                                    );\r\n                                })\r\n                            }\r\n                            {\r\n                                !this.state.devices && <FontAwesomeIcon className=\"mx-auto text-white\" size=\"2x\" icon={faSpinner} spin/>\r\n                            }\r\n                            </ListGroup>\r\n                        </Popover.Content>\r\n                    </Popover>\r\n                }>\r\n                <Button \r\n                    variant=\"outline-light\" \r\n                    onClick={this.handleDisplayDeviceSelector}>\r\n                    <FontAwesomeIcon icon={faDesktop} />\r\n                </Button>\r\n            </OverlayTrigger>\r\n        );\r\n    }\r\n}\r\n\r\nexport default DevicesPopover;","import React, { Component } from 'react';\r\nimport {\r\n    Row,\r\n    Col,\r\n    Button,\r\n} from \"react-bootstrap\";\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { \r\n    faStepBackward,\r\n    faStepForward,\r\n    faPause,\r\n    faPlay,\r\n    faVolumeMute,\r\n    faVolumeUp, \r\n} from \"@fortawesome/free-solid-svg-icons\";\r\nimport RangeSlider from \"react-bootstrap-range-slider\";\r\n\r\nimport SpotifyService from '../../services/spotify';\r\nimport {\r\n    getFormattedArtists\r\n} from \"../../helpers/spotifyHelper\";\r\nimport DevicesPopover from './DevicesPopover';\r\n\r\n// Formats total milliseconds to a displayable time format (like 00:00)\r\nfunction msToTime(millisec) {\r\n    var seconds = (millisec / 1000).toFixed(0);\r\n    var minutes = Math.floor(seconds / 60);\r\n    var hours = \"\";\r\n    if (minutes > 59) {\r\n        hours = Math.floor(minutes / 60);\r\n        hours = (hours >= 10) ? hours : \"0\" + hours;\r\n        minutes = minutes - (hours * 60);\r\n        minutes = (minutes >= 10) ? minutes : \"0\" + minutes;\r\n    }\r\n\r\n    seconds = Math.floor(seconds % 60);\r\n    seconds = (seconds >= 10) ? seconds : \"0\" + seconds;\r\n    if (hours !== \"\") {\r\n        return hours + \":\" + minutes + \":\" + seconds;\r\n    }\r\n    return minutes + \":\" + seconds;\r\n}\r\n\r\n/// Gets the largest album art from Spotify\r\nfunction retrieveAlbumArt(playState) {\r\n    // Default img if no album art found\r\n    let url = \"https://via.placeholder.com/75\";\r\n    if (playState) {\r\n        if (playState.item.album && playState.item.album.images.length > 0) {   \r\n            // Get biggest (first) art\r\n            let image = playState.item.album.images[0];\r\n            url = image.url;\r\n        }\r\n    } \r\n\r\n    return url;\r\n}\r\n\r\nclass Player extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            auth: props.auth,\r\n            playState: props.playState,\r\n\r\n            volumePercent: props.playState ? props.playState.device?.volume_percent : 0,\r\n            trackProgressMs: props.playState ? props.playState.progress_ms : 0,\r\n            isChangingTrackProgress: false,\r\n        };\r\n\r\n        this.onPlayPause = this.onPlayPause.bind(this);\r\n        this.onNextTrack = this.onNextTrack.bind(this);\r\n        this.onPreviousTrack = this.onPreviousTrack.bind(this);\r\n        this.onToggleVolumeMute = this.onToggleVolumeMute.bind(this);\r\n        this.onVolumeChanged = this.onVolumeChanged.bind(this);\r\n        this.onFinishVolumeChanged = this.onFinishVolumeChanged.bind(this);\r\n        this.onProgressChanged = this.onProgressChanged.bind(this);\r\n        this.onFinishProgressChanged = this.onFinishProgressChanged.bind(this);\r\n        this.updatePlaybackDevices = this.updatePlaybackDevices.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        setInterval(() => {\r\n            this.updatePlaybackDevices();\r\n        }, 3000);\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        if (prevProps.playState !== this.props.playState) {\r\n            this.setState({\r\n                playState: this.props.playState,\r\n\r\n                volumePercent: this.props.playState?.device?.volume_percent,\r\n                trackProgressMs: this.props.playState?.progress_ms,\r\n            });\r\n        }\r\n\r\n        if(prevProps.auth !== this.props.auth) {\r\n            this.setState({\r\n                auth: this.props.auth,\r\n            });\r\n        }\r\n    }\r\n\r\n    onPlayPause() {\r\n        if (this.state.playState) {\r\n            if (this.state.playState.is_playing) {\r\n                SpotifyService.pause(this.state.auth.authToken);\r\n            } else {\r\n                SpotifyService.play(this.state.auth.authToken);\r\n            }\r\n        }\r\n    }\r\n\r\n    onNextTrack() {\r\n        SpotifyService.nextTrack(this.state.auth.authToken);\r\n    }\r\n    \r\n    onPreviousTrack() {\r\n        SpotifyService.previousTrack(this.state.auth.authToken);\r\n    }\r\n\r\n    onToggleVolumeMute() {\r\n        if (this.state.playState) {\r\n            if (this.state.playState.device?.volume_percent > 0) {\r\n                SpotifyService.setVolume(this.state.auth.authToken, 0);\r\n            } else {\r\n                SpotifyService.setVolume(this.state.auth.authToken, 25);\r\n            }\r\n        }\r\n    }\r\n    \r\n    onVolumeChanged(changedEvent) {\r\n        this.setState({\r\n            volumePercent: parseInt(changedEvent.target.value),\r\n        });\r\n    }\r\n\r\n    onFinishVolumeChanged() {\r\n        if(this.state.volumePercent !== this.state.playState.device?.volume_percent) {\r\n            console.log(\"Web API: Set volume to \" + this.state.volumePercent);\r\n            SpotifyService.setVolume(this.state.auth.authToken, this.state.volumePercent);\r\n        }\r\n    }\r\n\r\n    onProgressChanged (changedEvent) {\r\n        this.setState({\r\n            trackProgressMs: parseInt(changedEvent.target.value),\r\n        });\r\n\r\n        if (!this.state.isChangingTrackProgress) {\r\n            this.setState({ isChangingTrackProgress: true });\r\n        }\r\n    }\r\n\r\n    onFinishProgressChanged() {\r\n        if(this.state.playState) {\r\n            if (this.state.playState.progress_ms !== this.state.trackProgressMs) {\r\n                SpotifyService.seek(this.state.auth.authToken, this.state.trackProgressMs);\r\n            }\r\n        }\r\n\r\n        this.setState({ isChangingTrackProgress: false });\r\n    }\r\n\r\n    updatePlaybackDevices() {\r\n        SpotifyService.getPlaybackDevices(this.state.auth?.authToken, (data) => {\r\n            /// Sort in alphabet order then move active device to top\r\n            let alphabet = data.devices.sort((x, y) => {\r\n                var xName = x.name.toUpperCase();\r\n                var yName = y.name.toUpperCase();\r\n                return (xName < yName) ? -1 : (xName > yName) ? 1 : 0;\r\n            });\r\n            let sortedDevices = alphabet.sort((x, y) => x.is_active ? -1 : y.is_active ? 1 : 0);\r\n            this.setState({\r\n                playbackDevices: sortedDevices,\r\n            });\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Row \r\n                className=\"w-100 mx-0 genify-player\" >\r\n                {/* Album Art & Song Info */}\r\n                <Col\r\n                    xl={3}\r\n                    lg={3} \r\n                    md={4}\r\n                    sm={5}\r\n                    xs={12}>\r\n                    <div className=\"d-flex align-items-center my-auto\">\r\n                        {\r\n                            this.state.playState &&\r\n                            <a \r\n                                href={ this.state.playState ? this.state.playState.item?.album?.external_urls?.spotify : \"#\" } \r\n                                className=\"ml-2 p-2\">\r\n                                <img \r\n                                    className=\"album-art\" \r\n                                    alt={ this.state.playState ? this.state.playState.item?.artists[0].name + \"Album Art\" : \"Unknown Album\" }\r\n                                    src={ retrieveAlbumArt(this.state.playState) }\r\n                                    style={{ maxWidth: \"75px\", maxHeight: \"75px\" }}></img>\r\n                            </a>\r\n                        }\r\n                        <div className=\"w-100 ml-2 song-info\">\r\n                            <a \r\n                                href={ this.state.playState ? this.state.playState.item?.external_urls?.spotify : \"#\" }>\r\n                                <h6>\r\n                                    { this.state.playState ? this.state.playState.item?.name : \"\" }\r\n                                </h6>\r\n                            </a>\r\n                            {/* Artists */}\r\n                            <h6>\r\n                                { this.state.playState ? getFormattedArtists(this.state.playState) : \"\" }\r\n                            </h6>\r\n                        </div>\r\n                    </div>\r\n                    {   \r\n                        !this.state.playState && \r\n                        <div className=\"my-auto\">\r\n                            <h6>No song currently playing.</h6>\r\n                            <h6>Play a song to get started!</h6>\r\n                        </div>\r\n                    }\r\n                </Col>\r\n                {/* Media Controls */}\r\n                <Col \r\n                    xl={6}\r\n                    lg={6}\r\n                    md={5}\r\n                    sm={7}\r\n                    className=\"d-none d-sm-block my-auto\">\r\n                    <div className=\"d-flex align-items-center my-1\">\r\n                        <div className=\"mx-auto my-1\">\r\n                            <Button \r\n                                className=\"mx-2\"\r\n                                variant=\"outline-light\"\r\n                                onClick={this.onPreviousTrack}>\r\n                                <FontAwesomeIcon icon={faStepBackward} />\r\n                            </Button>\r\n                            <Button \r\n                                className=\"mx-2\"\r\n                                variant=\"outline-light\"\r\n                                onClick={this.onPlayPause}>\r\n                                <FontAwesomeIcon icon={this.state.playState?.is_playing ? faPause : faPlay} />\r\n                            </Button>\r\n                            <Button \r\n                                className=\"mx-2\"\r\n                                variant=\"outline-light\"\r\n                                onClick={this.onNextTrack}>\r\n                                <FontAwesomeIcon icon={faStepForward} />\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"d-flex align-items-center my-1\">\r\n                        <h6 className=\"my-auto mx-2\">\r\n                            { this.state.playState && msToTime(this.state.isChangingTrackProgress ? this.state.trackProgressMs : this.state.playState.progress_ms) }    \r\n                            { !this.state.playState && \"0:00\" }\r\n                        </h6>\r\n                        <div \r\n                            className=\"w-100\"\r\n                            onMouseUp={this.onFinishProgressChanged}>\r\n                            <RangeSlider \r\n                                value={this.state.trackProgressMs}\r\n                                min={0}\r\n                                max={this.state.playState ? this.state.playState.item?.duration_ms : 100}\r\n                                onChange={this.onProgressChanged}\r\n                                tooltip=\"off\"\r\n                                />\r\n                        </div>\r\n                        <h6 className=\"my-auto mx-2\">\r\n                            { this.state.playState && msToTime(this.state.playState.item?.duration_ms) }\r\n                            { !this.state.playState && \"9:59\" }\r\n                        </h6>\r\n                    </div>\r\n                </Col>\r\n                {/* Volume, Devices */}\r\n                <Col \r\n                    xl={3}\r\n                    lg={3}\r\n                    md={3} \r\n                    className=\"d-none d-md-block my-auto\">\r\n                    <div className=\"d-flex align-items-center\">\r\n                        <DevicesPopover \r\n                            devices={this.state.playbackDevices}\r\n                            auth={this.state.auth}/>\r\n                        <Button \r\n                            className=\"mx-2\"\r\n                            variant=\"outline-light\"\r\n                            onClick={this.onToggleVolumeMute}>\r\n                            <FontAwesomeIcon icon={this.state.volumePercent === 0 ? faVolumeMute : faVolumeUp} />\r\n                        </Button>\r\n                        <div \r\n                            onMouseUp={this.onFinishVolumeChanged}\r\n                            className=\"w-100\">\r\n                            <RangeSlider\r\n                                value={this.state.volumePercent}\r\n                                onChange={this.onVolumeChanged}\r\n                                tooltip=\"auto\"\r\n                                variant='primary' />\r\n                        </div>\r\n                    </div>\r\n                </Col>\r\n            </Row>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Player;","import Player from \"./Player\";\r\n\r\nexport default Player;","import Service from \"./Service\";\r\n\r\nexport default Service;","import React, { Component } from 'react';\r\nimport {\r\n    Row,\r\n    Toast,\r\n} from \"react-bootstrap\";\r\nimport {\r\n    PLAYER_UPDATE_MS,\r\n    SPOTIFY_REFRESH_MINUTES\r\n} from \"../../consts\";\r\nimport { Redirect } from 'react-router-dom';\r\nimport Cookies from \"js-cookie\";\r\n\r\nimport SpotifyService from \"../../services/spotify\";\r\nimport { EGenifyCookieNames } from \"../../enums/cookies\";\r\nimport { hasAuthExpired } from \"../../helpers/spotifyHelper\";\r\n\r\nimport Lyrics from '../Lyrics/Lyrics';\r\nimport ContentSelector from \"../ContentSelector\";\r\nimport Settings from \"../Settings\";\r\nimport Player from \"../Player\";\r\n\r\nclass Service extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        // Retrieve saved auth in cookies\r\n        let redirect = \"\";\r\n        let auth = null;\r\n        let isRefreshing = false;\r\n        let authStringified = Cookies.get(EGenifyCookieNames.SPOTIFY_AUTH);\r\n\r\n        try {\r\n            auth = JSON.parse(authStringified);\r\n        } catch(e) {\r\n            console.error(\"Unable to parse auth cookie\");\r\n        }\r\n        \r\n        if (auth === null) {\r\n            redirect = \"/?auth=invalid\";\r\n            console.log(\"No auth in cookies or corrupted, going home\");\r\n        } else {\r\n            auth.expireDate = new Date(auth.expireDate);\r\n\r\n            // Check if auth has expired\r\n            if (auth.expireDate < Date.now()) {\r\n                // If auth has a refresh token, use it to refresh otherwise delete and redirect user to home\r\n                if(auth.refreshToken) {\r\n                    console.log(`Auth expired at '${auth.expireDate.toLocaleString()}'. Using refreshToken to get new auth'`);\r\n                    isRefreshing = true;\r\n                    this.refreshAuth(auth.refreshToken);\r\n                } else {\r\n                    Cookies.remove(EGenifyCookieNames.SPOTIFY_AUTH);\r\n                    redirect = \"/?auth=expired\";\r\n                    console.log(\"Auth found but has expired\");\r\n                }\r\n            } else {\r\n                console.log(`Auth found. Expires at '${auth.expireDate.toLocaleString()}'`);\r\n            }\r\n        }\r\n\r\n        this.state = {\r\n            auth: auth,\r\n            isRefreshingAuth: isRefreshing,\r\n            /// Timeout handle for auto refreshing auth\r\n            refreshAuthRoutine: null,\r\n            /// Interval handle for updating the current Spotify context\r\n            spotifyUpdateRoutine: null,\r\n\r\n            infoMessage: \"\",\r\n            showInfoMessage: false,\r\n\r\n            redirect: redirect,\r\n\r\n            mainContentPanel: \"lyrics\",\r\n        };\r\n\r\n        this.initService = this.initService.bind(this);\r\n        this.refreshAuth = this.refreshAuth.bind(this);\r\n\r\n        this.onContentPanelSelected = this.onContentPanelSelected.bind(this);\r\n    }\r\n    \r\n    componentDidMount() {\r\n        // If contains no auth and not refreshing, return home\r\n        if(this.state.auth === null && !this.state.isRefreshingAuth) {\r\n            this.setState({ redirect: \"/?auth=invalid\" });\r\n        }\r\n            \r\n        /// If contains a previous auth that is within expiry\r\n        if (this.state.auth !== null && !this.state.isRefreshingAuth) {\r\n            this.initService();\r\n        }\r\n    }\r\n\r\n    /// Initializes the service to perform the relevant actions on start\r\n    initService () {\r\n        // Get inital Spotify track status\r\n        SpotifyService.getCurrentPlaybackState(this.state.auth.authToken, (data) => {\r\n            // console.log(\"Initial State:\");\r\n            // console.log(data);\r\n            this.setState({\r\n                playState: data,\r\n                loaded: true,\r\n            });\r\n        });\r\n\r\n        if(!this.state.spotifyUpdateRoutine) {\r\n            // Start auto retrieval of Spotify track status\r\n            let spotifyUpdateRoutine = setInterval(() => {\r\n                if (hasAuthExpired(this.state.auth)) {\r\n                    return;\r\n                }\r\n                SpotifyService.getCurrentPlaybackState(this.state.auth.authToken, (data) => {\r\n                    // If track changed\r\n                    if (data.item?.name !== this.state.playState.item?.name) {\r\n                        console.log(`TRACK CHANGED | ${data.item.artists[0].name} - ${data.item?.name}`);\r\n                    }\r\n                    this.setState({\r\n                        playState: data,\r\n                    });\r\n                });\r\n            }, PLAYER_UPDATE_MS);\r\n\r\n            this.setState({ updateRoutine: spotifyUpdateRoutine });\r\n        }\r\n\r\n        if (!this.state.refreshAuthRoutine) {\r\n            let expireMs = this.state.auth.expireDate - new Date(Date.now());\r\n            let refreshAuthRoutine = setTimeout(() => {\r\n                console.log(`Auth will expire in ${SPOTIFY_REFRESH_MINUTES} minute(s). Refreshing...`);\r\n                this.setState({\r\n                    refreshAuthRoutine: null,\r\n                });\r\n                this.refreshAuth(this.state.auth.refreshToken);\r\n            }, expireMs - SPOTIFY_REFRESH_MINUTES * 60 * 1000);\r\n\r\n            this.setState({\r\n                refreshAuthRoutine: refreshAuthRoutine,\r\n            });\r\n        }\r\n    }\r\n\r\n    /// Performes a refresh of the current Spotify auth\r\n    refreshAuth (refreshToken) {\r\n        this.setState({\r\n            isRefreshingAuth: true,\r\n        });\r\n\r\n        SpotifyService.refreshAuth(refreshToken, (refreshedAuth) => {\r\n            let auth = SpotifyService.parseAuth(refreshedAuth);\r\n            if(auth) {\r\n                console.log(`Successfully refreshed auth. Expires at '${auth.expireDate.toLocaleString()}'`);\r\n                let stringified = JSON.stringify(auth);\r\n                Cookies.set(EGenifyCookieNames.SPOTIFY_AUTH, stringified, { path: '', expires: 365 });\r\n            } else {\r\n                // Unable to refresh the previous auth\r\n                console.error(\"Error when trying to refresh auth\");\r\n                Cookies.remove(EGenifyCookieNames.SPOTIFY_AUTH);\r\n                this.setState({ redirect: \"/?auth=refresh_error\" })\r\n            }\r\n\r\n            this.setState({\r\n                isRefreshingAuth: false,\r\n                auth: auth,\r\n            }, () => {\r\n                this.initService();\r\n            });\r\n        });\r\n    }\r\n\r\n    onContentPanelSelected(panel) {\r\n        if (panel !== this.state.mainContentPanel) {\r\n            //console.log(`Content changed to '${panel}'`);\r\n            this.setState({\r\n                mainContentPanel: panel,\r\n            });\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div\r\n                className=\"genify-home genify-dark-background\">\r\n                <Row className=\"mx-0\">\r\n                    <Player \r\n                        playState={this.state.playState}\r\n                        auth={this.state.auth} />\r\n                </Row>\r\n                {/* Main content selection nav */}\r\n                <div className=\"main-content-container\">\r\n                    <Row\r\n                        className=\"content-nav mx-0\">\r\n                        <ContentSelector \r\n                            onContentSelected={this.onContentPanelSelected} />\r\n                    </Row>\r\n                    <Row className=\"focused-content-container mx-0\">\r\n                        <div className={\"w-100 h-100 \" + (this.state.mainContentPanel === \"lyrics\" ? \"d-block\" : \"d-none\")} >\r\n                            <Lyrics playState={this.state.playState} />\r\n                        </div>\r\n                        <div className={\"w-100 h-100 \" + (this.state.mainContentPanel === \"settings\" ? \"d-block\" : \"d-none\")}>\r\n                            <Settings auth={this.state.auth} />\r\n                        </div>\r\n                    </Row>\r\n                </div>\r\n                {\r\n                    this.state.infoMessage &&\r\n                    <Toast \r\n                        show={this.state.showInfoMessage}\r\n                        onClose={() => this.setState({ showInfoMessage: false })}\r\n                        className=\"mr-2 mb-2 text-left\"\r\n                        style={{\r\n                            position: 'absolute',\r\n                            bottom: 0,\r\n                            right: 0,\r\n                            color: \"black\",\r\n                        }}>\r\n                        <Toast.Header>\r\n                            <strong className=\"mr-auto\">Info</strong>\r\n                            {/* <small>11 mins ago</small> */}\r\n                        </Toast.Header>\r\n                        <Toast.Body>\r\n                            { this.state.infoMessage }\r\n                        </Toast.Body>\r\n                    </Toast>\r\n                }\r\n\r\n                {\r\n                    this.state.redirect && <Redirect to={this.state.redirect} />\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Service;","import React, { Component } from 'react';\r\nimport { Redirect } from 'react-router-dom';\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faSpinner } from \"@fortawesome/free-solid-svg-icons\";\r\nimport Cookies from \"js-cookie\";\r\n\r\nimport { EGenifyCookieNames } from \"../../enums/cookies\";\r\nimport SpotifyService from \"../../services/spotify\";\r\n\r\nclass Callback extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        let exchangeData = { };\r\n        if (props.location?.search) {\r\n            /// Remove ? and split by params\r\n            let split = props.location.search.substring(1).split(\"&\");\r\n            if (split.length <= 2) {\r\n                for(let keyValue of split){\r\n                    let kvSplit = keyValue.split('=');\r\n                    if(keyValue.includes(\"code\")) {\r\n                        exchangeData.code = kvSplit[1];\r\n                    } else if(keyValue.includes(\"state\")) {\r\n                        exchangeData.state = kvSplit[1];\r\n                    } else if(keyValue.includes(\"error\")) {\r\n                        exchangeData.error = kvSplit[1];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        this.state = {\r\n            exchangeData: exchangeData,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if(this.state.exchangeData) {\r\n            SpotifyService.exchangePKCECode(this.state.exchangeData.code, (authData) => {\r\n                let auth = SpotifyService.parseAuth(authData);\r\n                if(auth) {\r\n                    let stringified = JSON.stringify(auth);\r\n                    Cookies.set(EGenifyCookieNames.SPOTIFY_AUTH, stringified, { path: '', expires: 365 });\r\n                   \r\n                    console.log(\"Successfully saved auth! Redirecting...\");\r\n                    setTimeout(() => {\r\n                        this.setState({\r\n                            redirect: \"/app\",\r\n                        });\r\n                    }, 100);\r\n                } else {\r\n                    console.error(\"Unable to parse and save auth\");\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div\r\n                className=\"h-100 w-100 spotify-black\">\r\n                <h3 className=\"text-center pt-5\">\r\n                    Redirecting...\r\n                </h3>\r\n                <div className=\"mx-auto\" style={{ width: \"50px\" }}>\r\n                    <FontAwesomeIcon \r\n                        className=\"fa-spin\"\r\n                        size=\"3x\" \r\n                        icon={faSpinner} />\r\n                </div>\r\n                {\r\n                    this.state.redirect && <Redirect to={this.state.redirect} />\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Callback;","import App from \"./App\";\r\n\r\nexport default App;","import React, { Component } from 'react';\r\nimport { \r\n    Route,\r\n    Switch,\r\n    BrowserRouter\r\n} from 'react-router-dom';\r\n\r\nimport Home from \"../Home\";\r\nimport Navigation from \"../Navigation\";\r\nimport FourOhFour from \"../FourOhFour\";\r\nimport Service from \"../Service\";\r\n\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport 'react-bootstrap-range-slider/dist/react-bootstrap-range-slider.css';\r\nimport Callback from '../Callback/Callback';\r\n\r\nclass App extends Component {\r\n    render() {\r\n        return (\r\n            <BrowserRouter basename={process.env.PUBLIC_URL}>\r\n                <Navigation />\r\n\r\n                <Switch>\r\n                    {/* Homepage */}\r\n                    <Route exact path=\"/\" component={Home} />\r\n                    {/* Main App service page */}\r\n                    <Route exact path=\"/app\" component={Service} />\r\n                    {/* Spotify callback for retrieving/parsing auth*/}\r\n                    <Route exact path=\"/callback\" component={Callback} />\r\n                    {/* 404 error page handling */}\r\n                    <Route component={FourOhFour} />\r\n                </Switch>\r\n            </BrowserRouter>\r\n        );\r\n    }\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nimport App from './components/App';\r\nimport \"./index.css\";\r\n\r\nconst app = (\r\n    <React.StrictMode>\r\n        <App />\r\n    </React.StrictMode>\r\n);\r\n\r\nReactDOM.render(app, document.getElementById('root') );\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}